import{a as D,t as J,d as j}from"../chunks/disclose-version.DHuzV3mq.js";import{P as Se,S as Ne,R as E,F,G as ke,x as Ee,N as pe,a2 as Ie,a3 as Q,E as B,I as U,a4 as ge,Q as he,a5 as Ae,aq as P,z as W,ar as Oe,as as De,at as Te,m as Ce,Y as Z,au as Je,av as Re,M as Ue,aw as Le,U as Me,B as Ve,J as He,C as $e,a1 as ee,ax as Fe,ay as Be,az as Pe,aA as Ye,a9 as qe,p as z,i as G,s as x,j as k,aB as ae,k as S,ap as te,g as w,o as K,t as ne,a as ze,h as Ge}from"../chunks/runtime.DXb_nxmo.js";import{p as X,i as re,o as Ke}from"../chunks/index-client.FqsGrO9G.js";import{d as be,s as oe}from"../chunks/render.DgOdoMma.js";import{i as Xe}from"../chunks/lifecycle.BuByrBdv.js";import{b as se}from"../chunks/paths.DGc73dwb.js";let Y=null;function je(e,a){return a}function Qe(e,a,t,n){for(var r=[],s=a.length,l=0;l<s;l++)Re(a[l].e,r,!0);var _=s>0&&r.length===0&&t!==null;if(_){var p=t.parentNode;Ue(p),p.append(t),n.clear(),T(e,a[0].prev,a[s-1].next)}Le(r,()=>{for(var o=0;o<s;o++){var u=a[o];_||(n.delete(u.k),T(e,u.prev,u.next)),Me(u.e,!_)}})}function We(e,a,t,n,r,s=null){var l=e,_={flags:a,items:new Map,first:null};{var p=e;l=E?F(Ve(p)):p.appendChild(Se())}E&&ke();var o=null,u=!1;Ne(()=>{var c=t(),f=Ee(c)?c:c==null?[]:pe(c),v=f.length;if(u&&v===0)return;u=v===0;let d=!1;if(E){var g=l.data===Ie;g!==(v===0)&&(l=Q(),F(l),B(!1),d=!0)}if(E){for(var i=null,b,N=0;N<v;N++){if(U.nodeType===8&&U.data===He){l=U,d=!0,B(!1);break}var I=f[N],m=n(I,N);b=me(U,_,i,null,I,m,N,r,a),_.items.set(m,b),i=b}v>0&&F(Q())}E||Ze(f,_,l,r,a,n),s!==null&&(v===0?o?ge(o):o=he(()=>s(l)):o!==null&&Ae(o,()=>{o=null})),d&&B(!0),t()}),E&&(l=U)}function Ze(e,a,t,n,r,s){var l=e.length,_=a.items,p=a.first,o=p,u,c=null,f=[],v=[],d,g,i,b;for(b=0;b<l;b+=1){if(d=e[b],g=s(d,b),i=_.get(g),i===void 0){var N=o?o.e.nodes_start:t;c=me(N,a,c,c===null?a.first:c.next,d,g,b,n,r),_.set(g,c),f=[],v=[],o=c.next;continue}if(ea(i,d,b),i.e.f&P&&ge(i.e),i!==o){if(u!==void 0&&u.has(i)){if(f.length<v.length){var I=v[0],m;c=I.prev;var L=f[0],C=f[f.length-1];for(m=0;m<f.length;m+=1)le(f[m],I,t);for(m=0;m<v.length;m+=1)u.delete(v[m]);T(a,L.prev,C.next),T(a,c,L),T(a,C,I),o=I,c=C,b-=1,f=[],v=[]}else u.delete(i),le(i,o,t),T(a,i.prev,i.next),T(a,i,c===null?a.first:c.next),T(a,c,i),c=i;continue}for(f=[],v=[];o!==null&&o.k!==g;)o.e.f&P||(u??(u=new Set)).add(o),v.push(o),o=o.next;if(o===null)continue;i=o}f.push(i),c=i,o=i.next}if(o!==null||u!==void 0){for(var R=u===void 0?[]:pe(u);o!==null;)o.e.f&P||R.push(o),o=o.next;var A=R.length;if(A>0){var y=l===0?t:null;Qe(a,R,y,_)}}W.first=a.first&&a.first.e,W.last=c&&c.e}function ea(e,a,t,n){Oe(e.v,a),e.i=t}function me(e,a,t,n,r,s,l,_,p){var o=Y;try{var u=(p&De)!==0,c=(p&Te)===0,f=u?c?Ce(r):Z(r):r,v=p&Je?Z(l):l,d={i:v,v:f,k:s,a:null,e:null,prev:t,next:n};return Y=d,d.e=he(()=>_(e,f,v),E),d.e.prev=t&&t.e,d.e.next=n&&n.e,t===null?a.first=d:(t.next=d,t.e.next=d.e),n!==null&&(n.prev=d,n.e.prev=d.e),d}finally{Y=o}}function le(e,a,t){for(var n=e.next?e.next.e.nodes_start:t,r=a?a.e.nodes_start:t,s=e.e.nodes_start;s!==n;){var l=$e(s);r.before(s),s=l}}function T(e,a,t){a===null?e.first=t:(a.next=t,a.e.next=t&&t.e),t!==null&&(t.prev=a,t.e.prev=a&&a.e)}let ie=!1;function ye(){ie||(ie=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var a;if(!e.defaultPrevented)for(const t of e.target.elements)(a=t.__on_r)==null||a.call(t)})},{capture:!0}))}function M(e){if(E){var a=!1,t=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var n=e.value;H(e,"value",null),e.value=n}if(e.hasAttribute("checked")){var r=e.checked;H(e,"checked",null),e.checked=r}}};e.__on_r=t,Be(t),ye()}}function H(e,a,t,n){var r=e.__attributes??(e.__attributes={});E&&(r[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||r[a]!==(r[a]=t)&&(a==="style"&&"__styles"in e&&(e.__styles={}),a==="loading"&&(e[Pe]=t),t==null?e.removeAttribute(a):typeof t!="string"&&aa(e).includes(a)?e[a]=t:e.setAttribute(a,t))}var ce=new Map;function aa(e){var a=ce.get(e.nodeName);if(a)return a;ce.set(e.nodeName,a=[]);for(var t,n=ee(e),r=Element.prototype;r!==n;){t=Fe(n);for(var s in t)t[s].set&&a.push(s);n=ee(n)}return a}function ta(e,a,t,n=t){e.addEventListener(a,t);const r=e.__on_r;r?e.__on_r=()=>{r(),n()}:e.__on_r=n,ye()}function V(e,a,t=a){var n=Ye();ta(e,"input",()=>{var r=de(e)?ue(e.value):e.value;t(r),n&&r!==(r=a())&&(e.value=r??"")}),qe(()=>{var r=a();if(E&&e.defaultValue!==e.value){t(e.value);return}de(e)&&r===ue(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function de(e){var a=e.type;return a==="number"||a==="range"}function ue(e){return e===""?null:+e}const h=[];for(let e=0;e<256;++e)h.push((e+256).toString(16).slice(1));function na(e,a=0){return(h[e[a+0]]+h[e[a+1]]+h[e[a+2]]+h[e[a+3]]+"-"+h[e[a+4]]+h[e[a+5]]+"-"+h[e[a+6]]+h[e[a+7]]+"-"+h[e[a+8]]+h[e[a+9]]+"-"+h[e[a+10]]+h[e[a+11]]+h[e[a+12]]+h[e[a+13]]+h[e[a+14]]+h[e[a+15]]).toLowerCase()}let q;const ra=new Uint8Array(16);function oa(){if(!q){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");q=crypto.getRandomValues.bind(crypto)}return q(ra)}const sa=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),fe={randomUUID:sa};function la(e,a,t){if(fe.randomUUID&&!a&&!e)return fe.randomUUID();e=e||{};const n=e.random||(e.rng||oa)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,na(n)}let O=X({name:"name of scene",combatants:[]});const we=()=>({id:la(),name:"",initiative:0}),xe=e=>{Object.assign(O,e)},ia=e=>new Promise((a,t)=>{const n=new FileReader;n.onload=r=>{var s;try{const l=JSON.parse((s=r.target)==null?void 0:s.result);console.log("parsed JSON:",O),a(l)}catch(l){console.error("error parsing JSON:",l),alert("invalid JSON file"),t(l)}},n.onerror=r=>{console.error("error reading file:",r),t(r)},n.readAsText(e)}),ve=()=>{const e=JSON.stringify(O,null,2),a="data:application/json;charset=utf-8,"+encodeURIComponent(e),t=document.createElement("a");t.href=a,t.download="data.json",t.target="_blank",t.click()},ca=async e=>{if(e){const a=new File([JSON.stringify(e,null,2)],"data.json",{type:"application/json",lastModified:Date.now()});if(navigator.canShare&&navigator.canShare({files:[a]}))try{await navigator.share({files:[a],title:"Download JSON",text:"Download JSON file"})}catch(t){console.error("Error sharing JSON:",t),console.info("Try downloading file via data url fallback"),ve()}else ve()}else alert("No data to download")},da=e=>{const a=e.target;if(a&&a.files){const t=a.files[0];t&&ia(t).then(n=>{xe(n)})}};var ua=(e,a)=>a(),fa=J('<div class="navbar bg-base-100"><div class="flex-1"><a class="btn btn-ghost text-xl">Splittermond Tickleiste</a></div> <div class="flex-none space-x-2"><label for="battleScene" class="btn"><img width="30em" alt="download"> Upload JSON</label> <input type="file" id="battleScene" name="battleScene" accept="application/json" class="file-input battle-scene-file-input w-full max-w-xs svelte-pb5hh"> <button class="btn"><img width="30em" alt="download"> Download JSON</button></div></div>');function va(e,a){z(a,!1);const t=()=>{ca(O)};Xe();var n=fa(),r=x(k(n),2),s=k(r),l=k(s);H(l,"src",`${se??""}/svg/upload-svgrepo-com.svg`),ae(),S(s);var _=x(s,2);_.__change=[da];var p=x(_,2);p.__click=[ua,t];var o=k(p);H(o,"src",`${se??""}/svg/download-svgrepo-com.svg`),ae(),S(p),S(r),S(n),D(e,n),G()}be(["change","click"]);function _e(e,a,t){e.key==="Enter"&&(a(w(t)),K(t,X(we())))}function _a(e,a){K(a,!0)}function pa(e,a){K(a,!1)}var ga=(e,a,t)=>a(w(t)),ha=J('<input type="text" class="input input-bordered w-full max-w-xs">'),ba=J('<input type="number" class="input input-bordered w-full max-w-xs">'),ma=(e,a,t)=>a(w(t).id),ya=J('<tr><td><!></td><td><!></td><td><button class="btn">X</button></td></tr>'),wa=J('<div class="mx-48 mt-12 overflow-x-auto"><button class="btn">Edit</button> <button class="btn">Save Edit</button> <div class="mb-6"><button class="btn">Add Combatant</button> <input type="text" placeholder="Name..." class="input input-bordered w-full max-w-xs"> <input type="number" placeholder="Iniative..." class="input input-bordered w-full max-w-xs"></div> <table class="table"><thead><tr><th>Name</th><th>Initiative</th><th></th></tr></thead><tbody></tbody></table></div>');function xa(e,a){z(a,!0);let t=te(X(we())),n=te(!1);function r(g){g.name!==""&&O.combatants.push(g)}function s(g){O.combatants=O.combatants.filter(i=>i.id!==g)}var l=wa(),_=k(l);_.__click=[_a,n];var p=x(_,2);p.__click=[pa,n];var o=x(p,2),u=k(o);u.__click=[ga,r,t];var c=x(u,2);M(c),c.__keydown=[_e,r,t];var f=x(c,2);M(f),f.__keydown=[_e,r,t],S(o);var v=x(o,2),d=x(k(v));We(d,21,()=>O.combatants,je,(g,i)=>{var b=ya(),N=k(b),I=k(N);re(I,()=>w(n),A=>{var y=ha();M(y),V(y,()=>w(i).name,$=>w(i).name=$),D(A,y)},A=>{var y=j();ne(()=>oe(y,w(i).name)),D(A,y)}),S(N);var m=x(N),L=k(m);re(L,()=>w(n),A=>{var y=ba();M(y),V(y,()=>w(i).initiative,$=>w(i).initiative=$),D(A,y)},A=>{var y=j();ne(()=>oe(y,w(i).initiative)),D(A,y)}),S(m);var C=x(m),R=k(C);R.__click=[ma,s,i],S(C),S(b),D(g,b)}),S(d),S(v),S(l),V(c,()=>w(t).name,g=>w(t).name=g),V(f,()=>w(t).initiative,g=>w(t).initiative=g),D(e,l),G()}be(["click","keydown"]);const Sa=e=>{localStorage.setItem("scene",JSON.stringify(e)),console.log("Data saved to localStorage")},Na=()=>{const e=localStorage.getItem("scene");if(e){const a=JSON.parse(e);return console.log("scene loaded from localStorage"),a}return console.log("no scene found in localStorage"),null};var ka=J("<!> <!>",1);function Ca(e,a){z(a,!0),Ke(()=>{const s=Na();s&&xe(s)}),ze(()=>{Sa(O)});var t=ka(),n=Ge(t);va(n,{});var r=x(n,2);xa(r,{}),D(e,t),G()}export{Ca as component};
