import{a as R,t as W,d as _e}from"../chunks/disclose-version.P8rduZbM.js";import{S as ut,R as U,G as ft,x as gt,N as Ye,a6 as mt,a7 as $e,F as Ae,E as ye,I as ne,a4 as Ge,Q as Ke,a5 as ht,aq as be,z as Ne,ar as wt,as as _t,at as yt,m as bt,_ as Pe,au as xt,av as kt,M as St,aw as Ct,U as Et,J as Lt,C as $t,a3 as Be,ax as At,ay as Nt,az as Pt,aA as Bt,a9 as Tt,p as ce,i as ve,s as N,j as b,aB as le,k as x,t as K,o as ee,g as y,ap as Ee,h as je,aC as Dt,a as It}from"../chunks/runtime.DRoUPnGg.js";import{p as Z,b as ge,i as oe,o as Mt}from"../chunks/index-client.DDVO9nS3.js";import{d as we,s as ae}from"../chunks/render.cd-pL9ZZ.js";import{i as Xe}from"../chunks/lifecycle.DqyLwDbo.js";import{b as q}from"../chunks/paths.BWqDz1c_.js";let xe=null;function Qe(e,t){return t}function Rt(e,t,n,i){for(var o=[],s=t.length,c=0;c<s;c++)kt(t[c].e,o,!0);var m=s>0&&o.length===0&&n!==null;if(m){var a=n.parentNode;St(a),a.append(n),i.clear(),G(e,t[0].prev,t[s-1].next)}Ct(o,()=>{for(var l=0;l<s;l++){var r=t[l];m||(i.delete(r.k),G(e,r.prev,r.next)),Et(r.e,!m)}})}function Ze(e,t,n,i,o,s=null){var c=e,m={flags:t,items:new Map,first:null};U&&ft();var a=null,l=!1;ut(()=>{var r=n(),d=gt(r)?r:r==null?[]:Ye(r),v=d.length;if(l&&v===0)return;l=v===0;let f=!1;if(U){var g=c.data===mt;g!==(v===0)&&(c=$e(),Ae(c),ye(!1),f=!0)}if(U){for(var _=null,p,h=0;h<v;h++){if(ne.nodeType===8&&ne.data===Lt){c=ne,f=!0,ye(!1);break}var E=d[h],C=i(E,h);p=et(ne,m,_,null,E,C,h,o,t),m.items.set(C,p),_=p}v>0&&Ae($e())}U||Ht(d,m,c,o,t,i),s!==null&&(v===0?a?Ge(a):a=Ke(()=>s(c)):a!==null&&ht(a,()=>{a=null})),f&&ye(!0),n()}),U&&(c=ne)}function Ht(e,t,n,i,o,s){var c=e.length,m=t.items,a=t.first,l=a,r,d=null,v=[],f=[],g,_,p,h;for(h=0;h<c;h+=1){if(g=e[h],_=s(g,h),p=m.get(_),p===void 0){var E=l?l.e.nodes_start:n;d=et(E,t,d,d===null?t.first:d.next,g,_,h,i,o),m.set(_,d),v=[],f=[],l=d.next;continue}if(Ot(p,g,h),p.e.f&be&&Ge(p.e),p!==l){if(r!==void 0&&r.has(p)){if(v.length<f.length){var C=f[0],k;d=C.prev;var A=v[0],L=v[v.length-1];for(k=0;k<v.length;k+=1)Te(v[k],C,n);for(k=0;k<f.length;k+=1)r.delete(f[k]);G(t,A.prev,L.next),G(t,d,A),G(t,L,C),l=C,d=L,h-=1,v=[],f=[]}else r.delete(p),Te(p,l,n),G(t,p.prev,p.next),G(t,p,d===null?t.first:d.next),G(t,d,p),d=p;continue}for(v=[],f=[];l!==null&&l.k!==_;)l.e.f&be||(r??(r=new Set)).add(l),f.push(l),l=l.next;if(l===null)continue;p=l}v.push(p),d=p,l=p.next}if(l!==null||r!==void 0){for(var M=r===void 0?[]:Ye(r);l!==null;)l.e.f&be||M.push(l),l=l.next;var V=M.length;if(V>0){var $=null;Rt(t,M,$,m)}}Ne.first=t.first&&t.first.e,Ne.last=d&&d.e}function Ot(e,t,n,i){wt(e.v,t),e.i=n}function et(e,t,n,i,o,s,c,m,a){var l=xe;try{var r=(a&_t)!==0,d=(a&yt)===0,v=r?d?bt(o):Pe(o):o,f=a&xt?Pe(c):c,g={i:f,v,k:s,a:null,e:null,prev:n,next:i};return xe=g,g.e=Ke(()=>m(e,v,f),U),g.e.prev=n&&n.e,g.e.next=i&&i.e,n===null?t.first=g:(n.next=g,n.e.next=g.e),i!==null&&(i.prev=g,i.e.prev=g.e),g}finally{xe=l}}function Te(e,t,n){for(var i=e.next?e.next.e.nodes_start:n,o=t?t.e.nodes_start:n,s=e.e.nodes_start;s!==i;){var c=$t(s);o.before(s),s=c}}function G(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}let De=!1;function tt(){De||(De=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const n of e.target.elements)(t=n.__on_r)==null||t.call(n)})},{capture:!0}))}function ie(e){if(U){var t=!1,n=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var i=e.value;J(e,"value",null),e.value=i}if(e.hasAttribute("checked")){var o=e.checked;J(e,"checked",null),e.checked=o}}};e.__on_r=n,Nt(n),tt()}}function J(e,t,n,i){var o=e.__attributes??(e.__attributes={});U&&(o[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||o[t]!==(o[t]=n)&&(t==="style"&&"__styles"in e&&(e.__styles={}),t==="loading"&&(e[Pt]=n),n==null?e.removeAttribute(t):typeof n!="string"&&Wt(e).includes(t)?e[t]=n:e.setAttribute(t,n))}var Ie=new Map;function Wt(e){var t=Ie.get(e.nodeName);if(t)return t;Ie.set(e.nodeName,t=[]);for(var n,i=Be(e),o=Element.prototype;o!==i;){n=At(i);for(var s in n)n[s].set&&t.push(s);i=Be(i)}return t}function Ut(e,t){var n=e.__className,i=Jt(t);U&&e.className===i?e.__className=i:(n!==i||U&&e.className!==i)&&(t==null?e.removeAttribute("class"):e.className=i,e.__className=i)}function Jt(e){return e??""}function se(e,t,n){if(n){if(e.classList.contains(t))return;e.classList.add(t)}else{if(!e.classList.contains(t))return;e.classList.remove(t)}}function Ft(e,t,n,i=n){e.addEventListener(t,n);const o=e.__on_r;o?e.__on_r=()=>{o(),i()}:e.__on_r=i,tt()}function re(e,t,n=t){var i=Bt();Ft(e,"input",()=>{var o=Me(e)?Re(e.value):e.value;n(o),i&&o!==(o=t())&&(e.value=o??"")}),Tt(()=>{var o=t();if(U&&e.defaultValue!==e.value){n(e.value);return}Me(e)&&o===Re(e.value)||e.type==="date"&&!o&&!e.value||o!==e.value&&(e.value=o??"")})}function Me(e){var t=e.type;return t==="number"||t==="range"}function Re(e){return e===""?null:+e}const D=[];for(let e=0;e<256;++e)D.push((e+256).toString(16).slice(1));function zt(e,t=0){return(D[e[t+0]]+D[e[t+1]]+D[e[t+2]]+D[e[t+3]]+"-"+D[e[t+4]]+D[e[t+5]]+"-"+D[e[t+6]]+D[e[t+7]]+"-"+D[e[t+8]]+D[e[t+9]]+"-"+D[e[t+10]]+D[e[t+11]]+D[e[t+12]]+D[e[t+13]]+D[e[t+14]]+D[e[t+15]]).toLowerCase()}let ke;const qt=new Uint8Array(16);function Vt(){if(!ke){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ke=crypto.getRandomValues.bind(crypto)}return ke(qt)}const Yt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),He={randomUUID:Yt};function Gt(e,t,n){if(He.randomUUID&&!t&&!e)return He.randomUUID();e=e||{};const i=e.random||(e.rng||Vt)();return i[6]=i[6]&15|64,i[8]=i[8]&63|128,zt(i)}const Kt=e=>{localStorage.setItem("scene",JSON.stringify(e)),console.log("Data saved to localStorage")},jt=()=>{const e=localStorage.getItem("scene");if(e){const t=JSON.parse(e);return console.log("scene loaded from localStorage"),t}return console.log("no scene found in localStorage"),null};let O=Z({name:"name of scene",combatants:[]});const Oe=()=>({id:Gt(),name:"",initiative:0}),nt=e=>{console.log(`Load scene ${JSON.stringify(e)}`),Object.assign(O,e)},Xt=()=>{Kt(O)},ot=(e=null)=>{O.combatants.sort((t,n)=>{if(t.initiative!==n.initiative)return t.initiative-n.initiative;if(e){if(t.id===e.id)return 1;if(n.id===e.id)return-1}return 0})},Se=".splimo.json",Qt=e=>new Promise((t,n)=>{const i=new FileReader;i.onload=o=>{var s;try{const c=JSON.parse((s=o.target)==null?void 0:s.result);t(c)}catch(c){console.error("error parsing JSON:",c),alert("invalid JSON file"),n(c)}},i.onerror=o=>{console.error("error reading file:",o),n(o)},i.readAsText(e)}),We=(e,t)=>{const n=JSON.stringify(e,null,2),i="data:application/json;charset=utf-8,"+encodeURIComponent(n),o=document.createElement("a");o.href=i,o.download=t,o.target="_blank",o.click()},Zt=async(e,t="scene"+Se)=>{if(e){t.endsWith(Se)||(t+=Se);const n=[JSON.stringify(e,null,2)],i=new File(n,t,{type:"application/json",lastModified:Date.now()});if(navigator.canShare&&navigator.canShare({files:[i]}))try{await navigator.share({files:[i],title:"Download JSON",text:"Download JSON file"})}catch(o){console.error("Error sharing JSON:",o),console.info("Try downloading file via data url fallback"),We(e,t)}else We(e,t)}else alert("No data to download")};let Le={};function Ce(e={}){Le={animate:!0,allowClose:!0,overlayOpacity:.7,smoothScroll:!1,disableActiveInteraction:!1,showProgress:!1,stagePadding:10,stageRadius:5,popoverOffset:10,showButtons:["next","previous","close"],disableButtons:[],overlayColor:"#000",...e}}function u(e){return e?Le[e]:Le}function ue(e,t,n,i){return(e/=i/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t}function it(e){const t='a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input[type="text"]:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled]), select:not([disabled])';return e.flatMap(n=>{const i=n.matches(t),o=Array.from(n.querySelectorAll(t));return[...i?[n]:[],...o]}).filter(n=>getComputedStyle(n).pointerEvents!=="none"&&nn(n))}function rt(e){if(!e||tn(e))return;const t=u("smoothScroll");e.scrollIntoView({behavior:!t||en(e)?"auto":"smooth",inline:"center",block:"center"})}function en(e){if(!e||!e.parentElement)return;const t=e.parentElement;return t.scrollHeight>t.clientHeight}function tn(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}function nn(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}let me={};function B(e,t){me[e]=t}function w(e){return e?me[e]:me}function Ue(){me={}}let he={};function fe(e,t){he[e]=t}function Q(e){var t;(t=he[e])==null||t.call(he)}function on(){he={}}function rn(e,t,n,i){let o=w("__activeStagePosition");const s=o||n.getBoundingClientRect(),c=i.getBoundingClientRect(),m=ue(e,s.x,c.x-s.x,t),a=ue(e,s.y,c.y-s.y,t),l=ue(e,s.width,c.width-s.width,t),r=ue(e,s.height,c.height-s.height,t);o={x:m,y:a,width:l,height:r},at(o),B("__activeStagePosition",o)}function st(e){if(!e)return;const t=e.getBoundingClientRect(),n={x:t.x,y:t.y,width:t.width,height:t.height};B("__activeStagePosition",n),at(n)}function sn(){const e=w("__activeStagePosition"),t=w("__overlaySvg");if(!e)return;if(!t){console.warn("No stage svg found.");return}const n=window.innerWidth,i=window.innerHeight;t.setAttribute("viewBox",`0 0 ${n} ${i}`)}function an(e){const t=ln(e);document.body.appendChild(t),ct(t,n=>{n.target.tagName==="path"&&Q("overlayClick")}),B("__overlaySvg",t)}function at(e){const t=w("__overlaySvg");if(!t){an(e);return}const n=t.firstElementChild;if((n==null?void 0:n.tagName)!=="path")throw new Error("no path element found in stage svg");n.setAttribute("d",lt(e))}function ln(e){const t=window.innerWidth,n=window.innerHeight,i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.classList.add("driver-overlay","driver-overlay-animated"),i.setAttribute("viewBox",`0 0 ${t} ${n}`),i.setAttribute("xmlSpace","preserve"),i.setAttribute("xmlnsXlink","http://www.w3.org/1999/xlink"),i.setAttribute("version","1.1"),i.setAttribute("preserveAspectRatio","xMinYMin slice"),i.style.fillRule="evenodd",i.style.clipRule="evenodd",i.style.strokeLinejoin="round",i.style.strokeMiterlimit="2",i.style.zIndex="10000",i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.width="100%",i.style.height="100%";const o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("d",lt(e)),o.style.fill=u("overlayColor")||"rgb(0,0,0)",o.style.opacity=`${u("overlayOpacity")}`,o.style.pointerEvents="auto",o.style.cursor="auto",i.appendChild(o),i}function lt(e){const t=window.innerWidth,n=window.innerHeight,i=u("stagePadding")||0,o=u("stageRadius")||0,s=e.width+i*2,c=e.height+i*2,m=Math.min(o,s/2,c/2),a=Math.floor(Math.max(m,0)),l=e.x-i+a,r=e.y-i,d=s-a*2,v=c-a*2;return`M${t},0L0,0L0,${n}L${t},${n}L${t},0Z
    M${l},${r} h${d} a${a},${a} 0 0 1 ${a},${a} v${v} a${a},${a} 0 0 1 -${a},${a} h-${d} a${a},${a} 0 0 1 -${a},-${a} v-${v} a${a},${a} 0 0 1 ${a},-${a} z`}function dn(){const e=w("__overlaySvg");e&&e.remove()}function cn(){const e=document.getElementById("driver-dummy-element");if(e)return e;let t=document.createElement("div");return t.id="driver-dummy-element",t.style.width="0",t.style.height="0",t.style.pointerEvents="none",t.style.opacity="0",t.style.position="fixed",t.style.top="50%",t.style.left="50%",document.body.appendChild(t),t}function Je(e){const{element:t}=e;let n=typeof t=="string"?document.querySelector(t):t;n||(n=cn()),pn(n,e)}function vn(){const e=w("__activeElement"),t=w("__activeStep");e&&(st(e),sn(),pt(e,t))}function pn(e,t){const n=Date.now(),i=w("__activeStep"),o=w("__activeElement")||e,s=!o||o===e,c=e.id==="driver-dummy-element",m=o.id==="driver-dummy-element",a=u("animate"),l=t.onHighlightStarted||u("onHighlightStarted"),r=(t==null?void 0:t.onHighlighted)||u("onHighlighted"),d=(i==null?void 0:i.onDeselected)||u("onDeselected"),v=u(),f=w();!s&&d&&d(m?void 0:o,i,{config:v,state:f}),l&&l(c?void 0:e,t,{config:v,state:f});const g=!s&&a;let _=!1;hn(),B("previousStep",i),B("previousElement",o),B("activeStep",t),B("activeElement",e);const p=()=>{if(w("__transitionCallback")!==p)return;const h=Date.now()-n,E=400-h<=400/2;t.popover&&E&&!_&&g&&(Fe(e,t),_=!0),u("animate")&&h<400?rn(h,400,o,e):(st(e),r&&r(c?void 0:e,t,{config:u(),state:w()}),B("__transitionCallback",void 0),B("__previousStep",i),B("__previousElement",o),B("__activeStep",t),B("__activeElement",e)),window.requestAnimationFrame(p)};B("__transitionCallback",p),window.requestAnimationFrame(p),rt(e),!g&&t.popover&&Fe(e,t),o.classList.remove("driver-active-element","driver-no-interaction"),o.removeAttribute("aria-haspopup"),o.removeAttribute("aria-expanded"),o.removeAttribute("aria-controls"),u("disableActiveInteraction")&&e.classList.add("driver-no-interaction"),e.classList.add("driver-active-element"),e.setAttribute("aria-haspopup","dialog"),e.setAttribute("aria-expanded","true"),e.setAttribute("aria-controls","driver-popover-content")}function un(){var e;(e=document.getElementById("driver-dummy-element"))==null||e.remove(),document.querySelectorAll(".driver-active-element").forEach(t=>{t.classList.remove("driver-active-element","driver-no-interaction"),t.removeAttribute("aria-haspopup"),t.removeAttribute("aria-expanded"),t.removeAttribute("aria-controls")})}function de(){const e=w("__resizeTimeout");e&&window.cancelAnimationFrame(e),B("__resizeTimeout",window.requestAnimationFrame(vn))}function fn(e){var t;if(!w("isInitialized")||!(e.key==="Tab"||e.keyCode===9))return;const n=w("__activeElement"),i=(t=w("popover"))==null?void 0:t.wrapper,o=it([...i?[i]:[],...n?[n]:[]]),s=o[0],c=o[o.length-1];if(e.preventDefault(),e.shiftKey){const m=o[o.indexOf(document.activeElement)-1]||c;m==null||m.focus()}else{const m=o[o.indexOf(document.activeElement)+1]||s;m==null||m.focus()}}function dt(e){var t;((t=u("allowKeyboardControl"))==null||t)&&(e.key==="Escape"?Q("escapePress"):e.key==="ArrowRight"?Q("arrowRightPress"):e.key==="ArrowLeft"&&Q("arrowLeftPress"))}function ct(e,t,n){const i=(o,s)=>{const c=o.target;e.contains(c)&&((!n||n(c))&&(o.preventDefault(),o.stopPropagation(),o.stopImmediatePropagation()),s==null||s(o))};document.addEventListener("pointerdown",i,!0),document.addEventListener("mousedown",i,!0),document.addEventListener("pointerup",i,!0),document.addEventListener("mouseup",i,!0),document.addEventListener("click",o=>{i(o,t)},!0)}function gn(){window.addEventListener("keyup",dt,!1),window.addEventListener("keydown",fn,!1),window.addEventListener("resize",de),window.addEventListener("scroll",de)}function mn(){window.removeEventListener("keyup",dt),window.removeEventListener("resize",de),window.removeEventListener("scroll",de)}function hn(){const e=w("popover");e&&(e.wrapper.style.display="none")}function Fe(e,t){var n,i;let o=w("popover");o&&document.body.removeChild(o.wrapper),o=_n(),document.body.appendChild(o.wrapper);const{title:s,description:c,showButtons:m,disableButtons:a,showProgress:l,nextBtnText:r=u("nextBtnText")||"Next &rarr;",prevBtnText:d=u("prevBtnText")||"&larr; Previous",progressText:v=u("progressText")||"{current} of {total}"}=t.popover||{};o.nextButton.innerHTML=r,o.previousButton.innerHTML=d,o.progress.innerHTML=v,s?(o.title.innerHTML=s,o.title.style.display="block"):o.title.style.display="none",c?(o.description.innerHTML=c,o.description.style.display="block"):o.description.style.display="none";const f=m||u("showButtons"),g=l||u("showProgress")||!1,_=(f==null?void 0:f.includes("next"))||(f==null?void 0:f.includes("previous"))||g;o.closeButton.style.display=f.includes("close")?"block":"none",_?(o.footer.style.display="flex",o.progress.style.display=g?"block":"none",o.nextButton.style.display=f.includes("next")?"block":"none",o.previousButton.style.display=f.includes("previous")?"block":"none"):o.footer.style.display="none";const p=a||u("disableButtons")||[];p!=null&&p.includes("next")&&(o.nextButton.disabled=!0,o.nextButton.classList.add("driver-popover-btn-disabled")),p!=null&&p.includes("previous")&&(o.previousButton.disabled=!0,o.previousButton.classList.add("driver-popover-btn-disabled")),p!=null&&p.includes("close")&&(o.closeButton.disabled=!0,o.closeButton.classList.add("driver-popover-btn-disabled"));const h=o.wrapper;h.style.display="block",h.style.left="",h.style.top="",h.style.bottom="",h.style.right="",h.id="driver-popover-content",h.setAttribute("role","dialog"),h.setAttribute("aria-labelledby","driver-popover-title"),h.setAttribute("aria-describedby","driver-popover-description");const E=o.arrow;E.className="driver-popover-arrow";const C=((n=t.popover)==null?void 0:n.popoverClass)||u("popoverClass")||"";h.className=`driver-popover ${C}`.trim(),ct(o.wrapper,M=>{var V,$,S;const I=M.target,T=((V=t.popover)==null?void 0:V.onNextClick)||u("onNextClick"),H=(($=t.popover)==null?void 0:$.onPrevClick)||u("onPrevClick"),F=((S=t.popover)==null?void 0:S.onCloseClick)||u("onCloseClick");if(I.classList.contains("driver-popover-next-btn"))return T?T(e,t,{config:u(),state:w()}):Q("nextClick");if(I.classList.contains("driver-popover-prev-btn"))return H?H(e,t,{config:u(),state:w()}):Q("prevClick");if(I.classList.contains("driver-popover-close-btn"))return F?F(e,t,{config:u(),state:w()}):Q("closeClick")},M=>!(o!=null&&o.description.contains(M))&&!(o!=null&&o.title.contains(M))&&typeof M.className=="string"&&M.className.includes("driver-popover")),B("popover",o);const k=((i=t.popover)==null?void 0:i.onPopoverRender)||u("onPopoverRender");k&&k(o,{config:u(),state:w()}),pt(e,t),rt(h);const A=e.classList.contains("driver-dummy-element"),L=it([h,...A?[]:[e]]);L.length>0&&L[0].focus()}function vt(){const e=w("popover");if(!(e!=null&&e.wrapper))return;const t=e.wrapper.getBoundingClientRect(),n=u("stagePadding")||0,i=u("popoverOffset")||0;return{width:t.width+n+i,height:t.height+n+i,realWidth:t.width,realHeight:t.height}}function ze(e,t){const{elementDimensions:n,popoverDimensions:i,popoverPadding:o,popoverArrowDimensions:s}=t;return e==="start"?Math.max(Math.min(n.top-o,window.innerHeight-i.realHeight-s.width),s.width):e==="end"?Math.max(Math.min(n.top-(i==null?void 0:i.realHeight)+n.height+o,window.innerHeight-(i==null?void 0:i.realHeight)-s.width),s.width):e==="center"?Math.max(Math.min(n.top+n.height/2-(i==null?void 0:i.realHeight)/2,window.innerHeight-(i==null?void 0:i.realHeight)-s.width),s.width):0}function qe(e,t){const{elementDimensions:n,popoverDimensions:i,popoverPadding:o,popoverArrowDimensions:s}=t;return e==="start"?Math.max(Math.min(n.left-o,window.innerWidth-i.realWidth-s.width),s.width):e==="end"?Math.max(Math.min(n.left-(i==null?void 0:i.realWidth)+n.width+o,window.innerWidth-(i==null?void 0:i.realWidth)-s.width),s.width):e==="center"?Math.max(Math.min(n.left+n.width/2-(i==null?void 0:i.realWidth)/2,window.innerWidth-(i==null?void 0:i.realWidth)-s.width),s.width):0}function pt(e,t){const n=w("popover");if(!n)return;const{align:i="start",side:o="left"}=(t==null?void 0:t.popover)||{},s=i,c=e.id==="driver-dummy-element"?"over":o,m=u("stagePadding")||0,a=vt(),l=n.arrow.getBoundingClientRect(),r=e.getBoundingClientRect(),d=r.top-a.height;let v=d>=0;const f=window.innerHeight-(r.bottom+a.height);let g=f>=0;const _=r.left-a.width;let p=_>=0;const h=window.innerWidth-(r.right+a.width);let E=h>=0;const C=!v&&!g&&!p&&!E;let k=c;if(c==="top"&&v?E=p=g=!1:c==="bottom"&&g?E=p=v=!1:c==="left"&&p?E=v=g=!1:c==="right"&&E&&(p=v=g=!1),c==="over"){const A=window.innerWidth/2-a.realWidth/2,L=window.innerHeight/2-a.realHeight/2;n.wrapper.style.left=`${A}px`,n.wrapper.style.right="auto",n.wrapper.style.top=`${L}px`,n.wrapper.style.bottom="auto"}else if(C){const A=window.innerWidth/2-(a==null?void 0:a.realWidth)/2,L=10;n.wrapper.style.left=`${A}px`,n.wrapper.style.right="auto",n.wrapper.style.bottom=`${L}px`,n.wrapper.style.top="auto"}else if(p){const A=Math.min(_,window.innerWidth-(a==null?void 0:a.realWidth)-l.width),L=ze(s,{elementDimensions:r,popoverDimensions:a,popoverPadding:m,popoverArrowDimensions:l});n.wrapper.style.left=`${A}px`,n.wrapper.style.top=`${L}px`,n.wrapper.style.bottom="auto",n.wrapper.style.right="auto",k="left"}else if(E){const A=Math.min(h,window.innerWidth-(a==null?void 0:a.realWidth)-l.width),L=ze(s,{elementDimensions:r,popoverDimensions:a,popoverPadding:m,popoverArrowDimensions:l});n.wrapper.style.right=`${A}px`,n.wrapper.style.top=`${L}px`,n.wrapper.style.bottom="auto",n.wrapper.style.left="auto",k="right"}else if(v){const A=Math.min(d,window.innerHeight-a.realHeight-l.width);let L=qe(s,{elementDimensions:r,popoverDimensions:a,popoverPadding:m,popoverArrowDimensions:l});n.wrapper.style.top=`${A}px`,n.wrapper.style.left=`${L}px`,n.wrapper.style.bottom="auto",n.wrapper.style.right="auto",k="top"}else if(g){const A=Math.min(f,window.innerHeight-(a==null?void 0:a.realHeight)-l.width);let L=qe(s,{elementDimensions:r,popoverDimensions:a,popoverPadding:m,popoverArrowDimensions:l});n.wrapper.style.left=`${L}px`,n.wrapper.style.bottom=`${A}px`,n.wrapper.style.top="auto",n.wrapper.style.right="auto",k="bottom"}C?n.arrow.classList.add("driver-popover-arrow-none"):wn(s,k,e)}function wn(e,t,n){const i=w("popover");if(!i)return;const o=n.getBoundingClientRect(),s=vt(),c=i.arrow,m=s.width,a=window.innerWidth,l=o.width,r=o.left,d=s.height,v=window.innerHeight,f=o.top,g=o.height;c.className="driver-popover-arrow";let _=t,p=e;t==="top"?(r+l<=0?(_="right",p="end"):r+l-m<=0&&(_="top",p="start"),r>=a?(_="left",p="end"):r+m>=a&&(_="top",p="end")):t==="bottom"?(r+l<=0?(_="right",p="start"):r+l-m<=0&&(_="bottom",p="start"),r>=a?(_="left",p="start"):r+m>=a&&(_="bottom",p="end")):t==="left"?(f+g<=0?(_="bottom",p="end"):f+g-d<=0&&(_="left",p="start"),f>=v?(_="top",p="end"):f+d>=v&&(_="left",p="end")):t==="right"&&(f+g<=0?(_="bottom",p="start"):f+g-d<=0&&(_="right",p="start"),f>=v?(_="top",p="start"):f+d>=v&&(_="right",p="end")),_?(c.classList.add(`driver-popover-arrow-side-${_}`),c.classList.add(`driver-popover-arrow-align-${p}`)):c.classList.add("driver-popover-arrow-none")}function _n(){const e=document.createElement("div");e.classList.add("driver-popover");const t=document.createElement("div");t.classList.add("driver-popover-arrow");const n=document.createElement("header");n.id="driver-popover-title",n.classList.add("driver-popover-title"),n.style.display="none",n.innerText="Popover Title";const i=document.createElement("div");i.id="driver-popover-description",i.classList.add("driver-popover-description"),i.style.display="none",i.innerText="Popover description is here";const o=document.createElement("button");o.type="button",o.classList.add("driver-popover-close-btn"),o.setAttribute("aria-label","Close"),o.innerHTML="&times;";const s=document.createElement("footer");s.classList.add("driver-popover-footer");const c=document.createElement("span");c.classList.add("driver-popover-progress-text"),c.innerText="";const m=document.createElement("span");m.classList.add("driver-popover-navigation-btns");const a=document.createElement("button");a.type="button",a.classList.add("driver-popover-prev-btn"),a.innerHTML="&larr; Previous";const l=document.createElement("button");return l.type="button",l.classList.add("driver-popover-next-btn"),l.innerHTML="Next &rarr;",m.appendChild(a),m.appendChild(l),s.appendChild(c),s.appendChild(m),e.appendChild(o),e.appendChild(t),e.appendChild(n),e.appendChild(i),e.appendChild(s),{wrapper:e,arrow:t,title:n,description:i,footer:s,previousButton:a,nextButton:l,closeButton:o,footerButtons:m,progress:c}}function yn(){var e;const t=w("popover");t&&((e=t.wrapper.parentElement)==null||e.removeChild(t.wrapper))}function bn(e={}){Ce(e);function t(){u("allowClose")&&l()}function n(){const r=w("activeIndex"),d=u("steps")||[];if(typeof r>"u")return;const v=r+1;d[v]?a(v):l()}function i(){const r=w("activeIndex"),d=u("steps")||[];if(typeof r>"u")return;const v=r-1;d[v]?a(v):l()}function o(r){(u("steps")||[])[r]?a(r):l()}function s(){var r;if(w("__transitionCallback"))return;const d=w("activeIndex"),v=w("__activeStep"),f=w("__activeElement");if(typeof d>"u"||typeof v>"u"||typeof w("activeIndex")>"u")return;const g=((r=v.popover)==null?void 0:r.onPrevClick)||u("onPrevClick");if(g)return g(f,v,{config:u(),state:w()});i()}function c(){var r;if(w("__transitionCallback"))return;const d=w("activeIndex"),v=w("__activeStep"),f=w("__activeElement");if(typeof d>"u"||typeof v>"u")return;const g=((r=v.popover)==null?void 0:r.onNextClick)||u("onNextClick");if(g)return g(f,v,{config:u(),state:w()});n()}function m(){w("isInitialized")||(B("isInitialized",!0),document.body.classList.add("driver-active",u("animate")?"driver-fade":"driver-simple"),gn(),fe("overlayClick",t),fe("escapePress",t),fe("arrowLeftPress",s),fe("arrowRightPress",c))}function a(r=0){var d,v,f,g,_,p,h,E;const C=u("steps");if(!C){console.error("No steps to drive through"),l();return}if(!C[r]){l();return}B("__activeOnDestroyed",document.activeElement),B("activeIndex",r);const k=C[r],A=C[r+1],L=C[r-1],M=((d=k.popover)==null?void 0:d.doneBtnText)||u("doneBtnText")||"Done",V=u("allowClose"),$=typeof((v=k.popover)==null?void 0:v.showProgress)<"u"?(f=k.popover)==null?void 0:f.showProgress:u("showProgress"),S=(((g=k.popover)==null?void 0:g.progressText)||u("progressText")||"{{current}} of {{total}}").replace("{{current}}",`${r+1}`).replace("{{total}}",`${C.length}`),I=((_=k.popover)==null?void 0:_.showButtons)||u("showButtons"),T=["next","previous",...V?["close"]:[]].filter(j=>!(I!=null&&I.length)||I.includes(j)),H=((p=k.popover)==null?void 0:p.onNextClick)||u("onNextClick"),F=((h=k.popover)==null?void 0:h.onPrevClick)||u("onPrevClick"),Y=((E=k.popover)==null?void 0:E.onCloseClick)||u("onCloseClick");Je({...k,popover:{showButtons:T,nextBtnText:A?void 0:M,disableButtons:[...L?[]:["previous"]],showProgress:$,progressText:S,onNextClick:H||(()=>{A?a(r+1):l()}),onPrevClick:F||(()=>{a(r-1)}),onCloseClick:Y||(()=>{l()}),...(k==null?void 0:k.popover)||{}}})}function l(r=!0){const d=w("__activeElement"),v=w("__activeStep"),f=w("__activeOnDestroyed"),g=u("onDestroyStarted");if(r&&g){const h=!d||(d==null?void 0:d.id)==="driver-dummy-element";g(h?void 0:d,v,{config:u(),state:w()});return}const _=(v==null?void 0:v.onDeselected)||u("onDeselected"),p=u("onDestroyed");if(document.body.classList.remove("driver-active","driver-fade","driver-simple"),mn(),yn(),un(),dn(),on(),Ue(),d&&v){const h=d.id==="driver-dummy-element";_&&_(h?void 0:d,v,{config:u(),state:w()}),p&&p(h?void 0:d,v,{config:u(),state:w()})}f&&f.focus()}return{isActive:()=>w("isInitialized")||!1,refresh:de,drive:(r=0)=>{m(),a(r)},setConfig:Ce,setSteps:r=>{Ue(),Ce({...u(),steps:r})},getConfig:u,getState:w,getActiveIndex:()=>w("activeIndex"),isFirstStep:()=>w("activeIndex")===0,isLastStep:()=>{const r=u("steps")||[],d=w("activeIndex");return d!==void 0&&d===r.length-1},getActiveStep:()=>w("activeStep"),getActiveElement:()=>w("activeElement"),getPreviousElement:()=>w("previousElement"),getPreviousStep:()=>w("previousStep"),moveNext:n,movePrevious:i,moveTo:o,hasNextStep:()=>{const r=u("steps")||[],d=w("activeIndex");return d!==void 0&&r[d+1]},hasPreviousStep:()=>{const r=u("steps")||[],d=w("activeIndex");return d!==void 0&&r[d-1]},highlight:r=>{m(),Je({...r,popover:r.popover?{showButtons:[],showProgress:!1,progressText:"",...r.popover}:void 0})},destroy:()=>{l(!1)}}}var xn=(e,t)=>t(),kn=(e,t)=>t(),Sn=W('<div class="navbar bg-base-100 grap-4 border-b-4 border-primary-content"><div class="flex-1 "><a class="btn hidden md:flex btn-ghost text-xl">Splittermond Tickleiste</a></div> <div class="flex-none space-x-2"><label id="uploadButton" for="battleScene" class="btn"><img width="30em" alt="download"> <span class="hidden md:flex">Upload Scene</span></label> <input type="file" id="battleScene" name="battleScene" accept="application/json" class="battle-scene-file-input file-input w-full max-w-xs svelte-ekzg43"> <button id="downloadBtn" class="btn"><img width="30em" alt="download"> <span class="hidden md:flex">Download Scene</span></button> <button class="btn"><img width="30em" alt="download"></button></div></div>');function Cn(e,t){ce(t,!1);const n=g=>{const _=g.target;if(_&&_.files){const p=_.files[0];p&&Qt(p).then(h=>{nt(h)}),_.value=""}},i=()=>{let g=O.name.toLowerCase().trim().replace(/\s+/g,"_");Zt(O,g)},o=()=>{bn({showProgress:!0,steps:[{element:"#sceneTitle",popover:{title:"Scene Title",description:"Shows the current scene's name."}},{element:"#combatantsTable",popover:{title:"Combatants List",description:"Displays the list of combatants part of the scene."}},{element:"#editSceneBtn",popover:{title:"Edit Scene",description:"Toggles edit mode to change the scene name and combatants list."}},{element:"#runSceneBtn",popover:{title:"Run Scene",description:"Ends edit mode and runs the scene which effectively means that all combatants will be ordered by ascending initiative. <b>When clicking a combatant in run mode, let's your choose a number of ticks</b> to be added to the combatants initiative value, followed by a reordering. <br/><br/> You can re-enter <b>edit mode</b> any time."}},{element:"#downloadBtn",popover:{title:"Download Scene",description:"Lets you download the current scene as JSON file."}},{element:"#uploadButton",popover:{title:"Upload Scene",description:"Lets you choose a scene to load that was previously saved to your device."}}]}).drive()};Xe();var s=Sn(),c=N(b(s),2),m=b(c),a=b(m);J(a,"src",`${q??""}/svg/upload-svgrepo-com.svg`),le(2),x(m);var l=N(m,2);l.__change=n;var r=N(l,2);r.__click=[xn,i];var d=b(r);J(d,"src",`${q??""}/svg/download-svgrepo-com.svg`),le(2),x(r);var v=N(r,2);v.__click=[kn,o];var f=b(v);J(f,"src",`${q??""}/svg/circle-question-svgrepo-com.svg`),x(v),x(c),x(s),R(e,s),ve()}we(["change","click"]);var En=(e,t,n)=>t(y(n)),Ln=W('<button class="btn text-4xl w-full h-full aspect-square"> </button>'),$n=(e,t)=>t(),An=W('<dialog id="tickSelectionModal" class="modal"><div class="modal-box w-9/12 max-w-xl"><form method="dialog"><button class="btn btn-circle btn-ghost btn-sm absolute right-2 top-2">✕</button></form> <h3 class="mb-5 text-2xl font-bold">Select ticks</h3> <div class="grid grid-cols-5 gap-4"><!> <div><button class="btn w-full h-full aspect-square"><img class="min-w-10" alt="toggle negation"></button></div></div></div> <form method="dialog" class="modal-backdrop"><button>close</button></form></dialog>');function Nn(e,t){ce(t,!0);let n,i;const o=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20];let s=Ee(!1);function c(){return ee(s,!1),n.showModal(),new Promise(h=>{i=h})}function m(){n.close()}function a(h){m();let E=y(s)?-1:1;i(E*h)}function l(){ee(s,!y(s))}var r=An();ge(r,h=>n=h,()=>n);var d=b(r),v=N(b(d),4),f=b(v);Ze(f,17,()=>o,Qe,(h,E)=>{var C=Ln();C.__click=[En,a,E];var k=b(C,!0);x(C),K(()=>ae(k,y(E))),R(h,C)});var g=N(f,2),_=b(g);_.__click=[$n,l];var p=b(_);return J(p,"src",`${q??""}/svg/minus-svgrepo-com.svg`),x(_),x(g),x(v),x(d),le(2),x(r),K(()=>se(_,"btn-active",y(s))),R(e,r),ve({show:c})}we(["click"]);function Ve(e,t,n){e.key==="Enter"&&t(y(n))}function Pn(e,t,n){ee(t,Z(n.Editing))}function Bn(e,t,n){ee(t,Z(n.Running)),ot()}var Tn=W('<input type="text" placeholder="Scene name..." class="input input-bordered mr-4 w-full max-w-md">'),Dn=(e,t,n)=>t(y(n)),In=W('<div class="col-span-3 grid grid-cols-subgrid items-center gap-4 rounded-b-lg bg-gray-200 p-2"><div class="flex-1"><input type="text" placeholder="Name..." class="input input-bordered w-full max-w-md"></div> <div class="flex-1"><input type="number" placeholder="Initiative..." class="input input-bordered w-full max-w-20"></div> <div class="flex w-16 justify-center"><button class="btn"><img width="30" alt="add"></button></div></div>'),Mn=(e,t,n)=>t(y(n)),Rn=(e,t,n)=>t(y(n)),Hn=(e,t,n)=>t(y(n)),On=W('<input type="text" class="input input-bordered w-full max-w-md">'),Wn=W('<input type="number" class="input input-bordered w-full max-w-20">'),Un=(e,t,n)=>t(y(n).id),Jn=W('<button class="btn"><img width="30" alt="delete"></button>'),Fn=W('<div role="button" tabindex="0"><div class="flex-1 text-3xl"><!></div> <div class="flex-1 text-5xl"><!></div> <div class="flex w-16 justify-center"><!></div></div>'),zn=W('<!> <div class="w-full h-full overflow-x-auto p-4 md:m-auto md:w-[800px] md:px-20"><div class="navbar bg-base-100"><div id="sceneTitle" class="flex-1 text-3xl"><!></div> <div class="flex-none space-x-2"><button id="runSceneBtn" class="btn"><img width="30em" alt="download"> <span class="hidden md:flex">Run Scene</span></button> <button id="editSceneBtn" class="btn"><img width="30em" alt="toggle edit"> <span class="hidden md:flex">Edit Scene</span></button></div></div> <div id="combatantsTable" class="grid w-full grid-cols-[6fr_1fr_1fr] mt-4"><div class="col-span-3 grid grid-cols-subgrid gap-4 bg-gray-200 px-4 py-2 font-bold"><div>Name</div> <div id="initiativeColumn">Initiative</div> <div></div></div> <!> <!></div></div>',1);function qn(e,t){ce(t,!0);const n={Editing:"EDITING",Running:"RUNNING"};let i=Ee(Z(Oe())),o=Ee(Z(n.Running)),s,c;function m($){$.name!==""&&(O.combatants.push($),ee(i,Z(Oe())),s.focus(),s.select())}function a($){O.combatants=O.combatants.filter(S=>S.id!==$)}function l($){y(o)===n.Running&&c.show().then(S=>{$.initiative+=S,ot($)})}var r=zn(),d=je(r);ge(Nn(d,{}),$=>c=$,()=>c);var v=N(d,2),f=b(v),g=b(f),_=b(g);oe(_,()=>y(o)===n.Editing,$=>{var S=Tn();ie(S),re(S,()=>O.name,I=>O.name=I),R($,S)},$=>{var S=_e();K(()=>ae(S,O.name)),R($,S)}),x(g);var p=N(g,2),h=b(p);h.__click=[Bn,o,n];var E=b(h);J(E,"src",`${q??""}/svg/circle-play-svgrepo-com.svg`),le(2),x(h);var C=N(h,2);C.__click=[Pn,o,n];var k=b(C);J(k,"src",`${q??""}/svg/pencil-svgrepo-com.svg`),le(2),x(C),x(p),x(f);var A=N(f,2),L=b(A),M=N(L,2);oe(M,()=>y(o)===n.Editing,$=>{var S=In(),I=b(S),T=b(I);ge(T,X=>s=X,()=>s),ie(T),T.__keydown=[Ve,m,i],x(I);var H=N(I,2),F=b(H);ie(F),F.__keydown=[Ve,m,i],x(H);var Y=N(H,2),j=b(Y);j.__click=[Dn,m,i];var pe=b(j);J(pe,"src",`${q??""}/svg/plus-svgrepo-com.svg`),x(j),x(Y),x(S),re(T,()=>y(i).name,X=>y(i).name=X),re(F,()=>y(i).initiative,X=>y(i).initiative=X),R($,S)});var V=N(M,2);Ze(V,17,()=>O.combatants,Qe,($,S,I)=>{var T=Fn();T.__click=[Mn,l,S],T.__keydown=[Rn,l,S],T.__keyup=[Hn,l,S];var H=b(T),F=b(H);oe(F,()=>y(o)===n.Editing,z=>{var P=On();ie(P),re(P,()=>y(S).name,te=>y(S).name=te),R(z,P)},z=>{var P=_e();K(()=>ae(P,y(S).name)),R(z,P)}),x(H);var Y=N(H,2),j=b(Y);oe(j,()=>y(o)===n.Editing,z=>{var P=Wn();ie(P),re(P,()=>y(S).initiative,te=>y(S).initiative=te),R(z,P)},z=>{var P=_e();K(()=>ae(P,y(S).initiative)),R(z,P)}),x(Y);var pe=N(Y,2),X=b(pe);oe(X,()=>y(o)===n.Editing,z=>{var P=Jn();P.__click=[Un,a,S];var te=b(P);J(te,"src",`${q??""}/svg/trash-svgrepo-com.svg`),x(P),R(z,P)}),x(pe),x(T),K(()=>Ut(T,`col-span-3 grid grid-cols-subgrid items-center gap-4 p-6 rounded-lg ${(y(o)===n.Running?"cursor-pointer hover:bg-gray-100":"cursor-default")??""} ${(y(o)==n.Running&&I===0?"border-4 border-green-300/100":"")??""} ${(y(o)==n.Running&&I>=2?"border-t-4 border-primary-content rounded-none":"")??""}`)),R($,T)}),x(A),x(v),K(()=>{se(h,"btn-active",y(o)===n.Running),se(C,"btn-active",y(o)===n.Editing),se(L,"rounded-t-lg",y(o)===n.Editing),se(L,"rounded-lg",y(o)===n.Running)}),R(e,r),ve()}we(["click","keydown","keyup"]);var Vn=(e,t)=>y(t).showModal(),Yn=W(`<footer class="footer flex items-center p-4 text-neutral border-t-4 border-primary-content"><aside class="flex-1"><p> </p></aside> <button>Data Privacy</button> <nav class="flex-none"><a href="https://github.com/k3ltis/splittermond-tickleiste" target="_blank"><img width="30em" alt="github"></a></nav></footer> <dialog id="dataPrivacyModal" class="modal"><div class="modal-box"><h3 class="text-lg font-bold">Data Privacy Information</h3> <p class="py-4">This page does utilize the browser's local storage to locally save the scene in the user's browser. This is done, so that the user does not lose information when closing the browser application. If you wish to delete this information you can either clear your browser's cached web data or simply delete all entries while in the scene's edit mode.</p> <p>No data is send to any remove server and no other user related data is processed by this page.</p></div> <form method="dialog" class="modal-backdrop"><button>close</button></form></dialog>`,1);function Gn(e,t){ce(t,!1);let n=Dt();Xe();var i=Yn(),o=je(i),s=b(o),c=b(s),m=b(c);K(()=>ae(m,`Copyright © k3ltis ${new Date().getFullYear()??""}`)),x(c),x(s);var a=N(s,2);a.__click=[Vn,n];var l=N(a,2),r=b(l),d=b(r);J(d,"src",`${q??""}/svg/github-142-svgrepo-com.svg`),x(r),x(l),x(o);var v=N(o,2);ge(v,f=>ee(n,f),()=>y(n)),R(e,i),ve()}we(["click"]);var Kn=W('<div class="flex flex-col h-screen"><!> <!> <!></div>');function no(e,t){ce(t,!0),Mt(()=>{const c=jt();c&&nt(c)}),It(()=>{Xt()});var n=Kn(),i=b(n);Cn(i,{});var o=N(i,2);qn(o,{});var s=N(o,2);Gn(s,{}),x(n),R(e,n),ve()}export{no as component};
