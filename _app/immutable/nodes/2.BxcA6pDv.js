import{a as O,t as z,d as ge}from"../chunks/disclose-version.rcRw2RAa.js";import{P as mt,S as gt,aq as Ke,R as F,F as he,G as ht,x as wt,N as je,a6 as _t,a7 as Pe,E as we,I as te,a4 as Xe,Q as Qe,a5 as yt,ar as _e,aa as bt,z as Be,as as Le,at as Ne,au as Ae,av as xt,m as St,_ as Te,aw as kt,M as Ct,ax as Et,U as Lt,B as At,J as $t,ay as Pt,C as Bt,a3 as De,az as Nt,aA as Tt,aB as Dt,aC as It,a9 as Mt,p as pe,i as fe,s as I,j as E,aD as se,k as C,t as Q,o as me,g as k,ap as ke,h as Ze,a as Ht}from"../chunks/runtime.DXVpjAUZ.js";import{p as Z,b as Ce,i as ne,o as Rt}from"../chunks/index-client.-2ZAsmd_.js";import{d as $e,s as ce}from"../chunks/render.CVg5iJup.js";import{i as Ot}from"../chunks/lifecycle.DED4nl6c.js";import{b as K}from"../chunks/paths.4H2s3uom.js";let ye=null;function et(e,t){return t}function Wt(e,t,n,i){for(var o=[],s=t.length,d=0;d<s;d++)kt(t[d].e,o,!0);var w=s>0&&o.length===0&&n!==null;if(w){var a=n.parentNode;Ct(a),a.append(n),i.clear(),G(e,t[0].prev,t[s-1].next)}Et(o,()=>{for(var f=0;f<s;f++){var r=t[f];w||(i.delete(r.k),G(e,r.prev,r.next)),Lt(r.e,!w)}})}function tt(e,t,n,i,o,s=null){var d=e,w={flags:t,items:new Map,first:null},a=(t&Ke)!==0;if(a){var f=e;d=F?he(At(f)):f.appendChild(mt())}F&&ht();var r=null,l=!1;gt(()=>{var c=n(),p=wt(c)?c:c==null?[]:je(c),u=p.length;if(l&&u===0)return;l=u===0;let h=!1;if(F){var v=d.data===_t;v!==(u===0)&&(d=Pe(),he(d),we(!1),h=!0)}if(F){for(var y=null,S,_=0;_<u;_++){if(te.nodeType===8&&te.data===$t){d=te,h=!0,we(!1);break}var b=p[_],$=i(b,_);S=nt(te,w,y,null,b,$,_,o,t),w.items.set($,S),y=S}u>0&&he(Pe())}F||Ut(p,w,d,o,t,i),s!==null&&(u===0?r?Xe(r):r=Qe(()=>s(d)):r!==null&&yt(r,()=>{r=null})),h&&we(!0),n()}),F&&(d=te)}function Ut(e,t,n,i,o,s){var W,H,Y,J;var d=(o&Pt)!==0,w=(o&(Le|Ae))!==0,a=e.length,f=t.items,r=t.first,l=r,c,p=null,u,h=[],v=[],y,S,_,b;if(d)for(b=0;b<a;b+=1)y=e[b],S=s(y,b),_=f.get(S),_!==void 0&&((W=_.a)==null||W.measure(),(u??(u=new Set)).add(_));for(b=0;b<a;b+=1){if(y=e[b],S=s(y,b),_=f.get(S),_===void 0){var $=l?l.e.nodes_start:n;p=nt($,t,p,p===null?t.first:p.next,y,S,b,i,o),f.set(S,p),h=[],v=[],l=p.next;continue}if(w&&Jt(_,y,b,o),_.e.f&_e&&(Xe(_.e),d&&((H=_.a)==null||H.unfix(),(u??(u=new Set)).delete(_))),_!==l){if(c!==void 0&&c.has(_)){if(h.length<v.length){var L=v[0],B;p=L.prev;var V=h[0],A=h[h.length-1];for(B=0;B<h.length;B+=1)Ie(h[B],L,n);for(B=0;B<v.length;B+=1)c.delete(v[B]);G(t,V.prev,A.next),G(t,p,V),G(t,A,L),l=L,p=A,b-=1,h=[],v=[]}else c.delete(_),Ie(_,l,n),G(t,_.prev,_.next),G(t,_,p===null?t.first:p.next),G(t,p,_),p=_;continue}for(h=[],v=[];l!==null&&l.k!==S;)l.e.f&_e||(c??(c=new Set)).add(l),v.push(l),l=l.next;if(l===null)continue;_=l}h.push(_),p=_,l=_.next}if(l!==null||c!==void 0){for(var x=c===void 0?[]:je(c);l!==null;)l.e.f&_e||x.push(l),l=l.next;var P=x.length;if(P>0){var M=o&Ke&&a===0?n:null;if(d){for(b=0;b<P;b+=1)(Y=x[b].a)==null||Y.measure();for(b=0;b<P;b+=1)(J=x[b].a)==null||J.fix()}Wt(t,x,M,f)}}d&&bt(()=>{var X;if(u!==void 0)for(_ of u)(X=_.a)==null||X.apply()}),Be.first=t.first&&t.first.e,Be.last=p&&p.e}function Jt(e,t,n,i){i&Le&&Ne(e.v,t),i&Ae?Ne(e.i,n):e.i=n}function nt(e,t,n,i,o,s,d,w,a){var f=ye;try{var r=(a&Le)!==0,l=(a&xt)===0,c=r?l?St(o):Te(o):o,p=a&Ae?Te(d):d,u={i:p,v:c,k:s,a:null,e:null,prev:n,next:i};return ye=u,u.e=Qe(()=>w(e,c,p),F),u.e.prev=n&&n.e,u.e.next=i&&i.e,n===null?t.first=u:(n.next=u,n.e.next=u.e),i!==null&&(i.prev=u,i.e.prev=u.e),u}finally{ye=f}}function Ie(e,t,n){for(var i=e.next?e.next.e.nodes_start:n,o=t?t.e.nodes_start:n,s=e.e.nodes_start;s!==i;){var d=Bt(s);o.before(s),s=d}}function G(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}let Me=!1;function ot(){Me||(Me=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const n of e.target.elements)(t=n.__on_r)==null||t.call(n)})},{capture:!0}))}function oe(e){if(F){var t=!1,n=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var i=e.value;q(e,"value",null),e.value=i}if(e.hasAttribute("checked")){var o=e.checked;q(e,"checked",null),e.checked=o}}};e.__on_r=n,Tt(n),ot()}}function q(e,t,n,i){var o=e.__attributes??(e.__attributes={});F&&(o[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||o[t]!==(o[t]=n)&&(t==="style"&&"__styles"in e&&(e.__styles={}),t==="loading"&&(e[Dt]=n),n==null?e.removeAttribute(t):typeof n!="string"&&zt(e).includes(t)?e[t]=n:e.setAttribute(t,n))}var He=new Map;function zt(e){var t=He.get(e.nodeName);if(t)return t;He.set(e.nodeName,t=[]);for(var n,i=De(e),o=Element.prototype;o!==i;){n=Nt(i);for(var s in n)n[s].set&&t.push(s);i=De(i)}return t}function re(e,t,n){if(n){if(e.classList.contains(t))return;e.classList.add(t)}else{if(!e.classList.contains(t))return;e.classList.remove(t)}}function Ft(e,t,n,i=n){e.addEventListener(t,n);const o=e.__on_r;o?e.__on_r=()=>{o(),i()}:e.__on_r=i,ot()}function ie(e,t,n=t){var i=It();Ft(e,"input",()=>{var o=Re(e)?Oe(e.value):e.value;n(o),i&&o!==(o=t())&&(e.value=o??"")}),Mt(()=>{var o=t();if(F&&e.defaultValue!==e.value){n(e.value);return}Re(e)&&o===Oe(e.value)||e.type==="date"&&!o&&!e.value||o!==e.value&&(e.value=o??"")})}function Re(e){var t=e.type;return t==="number"||t==="range"}function Oe(e){return e===""?null:+e}const D=[];for(let e=0;e<256;++e)D.push((e+256).toString(16).slice(1));function qt(e,t=0){return(D[e[t+0]]+D[e[t+1]]+D[e[t+2]]+D[e[t+3]]+"-"+D[e[t+4]]+D[e[t+5]]+"-"+D[e[t+6]]+D[e[t+7]]+"-"+D[e[t+8]]+D[e[t+9]]+"-"+D[e[t+10]]+D[e[t+11]]+D[e[t+12]]+D[e[t+13]]+D[e[t+14]]+D[e[t+15]]).toLowerCase()}let be;const Vt=new Uint8Array(16);function Yt(){if(!be){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");be=crypto.getRandomValues.bind(crypto)}return be(Vt)}const Gt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),We={randomUUID:Gt};function Kt(e,t,n){if(We.randomUUID&&!t&&!e)return We.randomUUID();e=e||{};const i=e.random||(e.rng||Yt)();return i[6]=i[6]&15|64,i[8]=i[8]&63|128,qt(i)}const jt=e=>{localStorage.setItem("scene",JSON.stringify(e)),console.log("Data saved to localStorage")},Xt=()=>{const e=localStorage.getItem("scene");if(e){const t=JSON.parse(e);return console.log("scene loaded from localStorage"),t}return console.log("no scene found in localStorage"),null};let U=Z({name:"name of scene",combatants:[]});const Ue=()=>({id:Kt(),name:"",initiative:0}),it=e=>{console.log(`Load scene ${JSON.stringify(e)}`),Object.assign(U,e)},Qt=()=>{jt(U)},rt=()=>{U.combatants.sort((e,t)=>e.initiative-t.initiative)},xe=".splimo.json",Zt=e=>new Promise((t,n)=>{const i=new FileReader;i.onload=o=>{var s;try{const d=JSON.parse((s=o.target)==null?void 0:s.result);t(d)}catch(d){console.error("error parsing JSON:",d),alert("invalid JSON file"),n(d)}},i.onerror=o=>{console.error("error reading file:",o),n(o)},i.readAsText(e)}),Je=(e,t)=>{const n=JSON.stringify(e,null,2),i="data:application/json;charset=utf-8,"+encodeURIComponent(n),o=document.createElement("a");o.href=i,o.download=t,o.target="_blank",o.click()},en=async(e,t="scene"+xe)=>{if(e){t.endsWith(xe)||(t+=xe);const n=[JSON.stringify(e,null,2)],i=new File(n,t,{type:"application/json",lastModified:Date.now()});if(navigator.canShare&&navigator.canShare({files:[i]}))try{await navigator.share({files:[i],title:"Download JSON",text:"Download JSON file"})}catch(o){console.error("Error sharing JSON:",o),console.info("Try downloading file via data url fallback"),Je(e,t)}else Je(e,t)}else alert("No data to download")};let Ee={};function Se(e={}){Ee={animate:!0,allowClose:!0,overlayOpacity:.7,smoothScroll:!1,disableActiveInteraction:!1,showProgress:!1,stagePadding:10,stageRadius:5,popoverOffset:10,showButtons:["next","previous","close"],disableButtons:[],overlayColor:"#000",...e}}function m(e){return e?Ee[e]:Ee}function le(e,t,n,i){return(e/=i/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t}function st(e){const t='a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input[type="text"]:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled]), select:not([disabled])';return e.flatMap(n=>{const i=n.matches(t),o=Array.from(n.querySelectorAll(t));return[...i?[n]:[],...o]}).filter(n=>getComputedStyle(n).pointerEvents!=="none"&&on(n))}function at(e){if(!e||nn(e))return;const t=m("smoothScroll");e.scrollIntoView({behavior:!t||tn(e)?"auto":"smooth",inline:"center",block:"center"})}function tn(e){if(!e||!e.parentElement)return;const t=e.parentElement;return t.scrollHeight>t.clientHeight}function nn(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}function on(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}let ve={};function T(e,t){ve[e]=t}function g(e){return e?ve[e]:ve}function ze(){ve={}}let ue={};function de(e,t){ue[e]=t}function j(e){var t;(t=ue[e])==null||t.call(ue)}function rn(){ue={}}function sn(e,t,n,i){let o=g("__activeStagePosition");const s=o||n.getBoundingClientRect(),d=i.getBoundingClientRect(),w=le(e,s.x,d.x-s.x,t),a=le(e,s.y,d.y-s.y,t),f=le(e,s.width,d.width-s.width,t),r=le(e,s.height,d.height-s.height,t);o={x:w,y:a,width:f,height:r},dt(o),T("__activeStagePosition",o)}function lt(e){if(!e)return;const t=e.getBoundingClientRect(),n={x:t.x,y:t.y,width:t.width,height:t.height};T("__activeStagePosition",n),dt(n)}function an(){const e=g("__activeStagePosition"),t=g("__overlaySvg");if(!e)return;if(!t){console.warn("No stage svg found.");return}const n=window.innerWidth,i=window.innerHeight;t.setAttribute("viewBox",`0 0 ${n} ${i}`)}function ln(e){const t=dn(e);document.body.appendChild(t),ut(t,n=>{n.target.tagName==="path"&&j("overlayClick")}),T("__overlaySvg",t)}function dt(e){const t=g("__overlaySvg");if(!t){ln(e);return}const n=t.firstElementChild;if((n==null?void 0:n.tagName)!=="path")throw new Error("no path element found in stage svg");n.setAttribute("d",ct(e))}function dn(e){const t=window.innerWidth,n=window.innerHeight,i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.classList.add("driver-overlay","driver-overlay-animated"),i.setAttribute("viewBox",`0 0 ${t} ${n}`),i.setAttribute("xmlSpace","preserve"),i.setAttribute("xmlnsXlink","http://www.w3.org/1999/xlink"),i.setAttribute("version","1.1"),i.setAttribute("preserveAspectRatio","xMinYMin slice"),i.style.fillRule="evenodd",i.style.clipRule="evenodd",i.style.strokeLinejoin="round",i.style.strokeMiterlimit="2",i.style.zIndex="10000",i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.width="100%",i.style.height="100%";const o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("d",ct(e)),o.style.fill=m("overlayColor")||"rgb(0,0,0)",o.style.opacity=`${m("overlayOpacity")}`,o.style.pointerEvents="auto",o.style.cursor="auto",i.appendChild(o),i}function ct(e){const t=window.innerWidth,n=window.innerHeight,i=m("stagePadding")||0,o=m("stageRadius")||0,s=e.width+i*2,d=e.height+i*2,w=Math.min(o,s/2,d/2),a=Math.floor(Math.max(w,0)),f=e.x-i+a,r=e.y-i,l=s-a*2,c=d-a*2;return`M${t},0L0,0L0,${n}L${t},${n}L${t},0Z
    M${f},${r} h${l} a${a},${a} 0 0 1 ${a},${a} v${c} a${a},${a} 0 0 1 -${a},${a} h-${l} a${a},${a} 0 0 1 -${a},-${a} v-${c} a${a},${a} 0 0 1 ${a},-${a} z`}function cn(){const e=g("__overlaySvg");e&&e.remove()}function vn(){const e=document.getElementById("driver-dummy-element");if(e)return e;let t=document.createElement("div");return t.id="driver-dummy-element",t.style.width="0",t.style.height="0",t.style.pointerEvents="none",t.style.opacity="0",t.style.position="fixed",t.style.top="50%",t.style.left="50%",document.body.appendChild(t),t}function Fe(e){const{element:t}=e;let n=typeof t=="string"?document.querySelector(t):t;n||(n=vn()),pn(n,e)}function un(){const e=g("__activeElement"),t=g("__activeStep");e&&(lt(e),an(),ft(e,t))}function pn(e,t){const n=Date.now(),i=g("__activeStep"),o=g("__activeElement")||e,s=!o||o===e,d=e.id==="driver-dummy-element",w=o.id==="driver-dummy-element",a=m("animate"),f=t.onHighlightStarted||m("onHighlightStarted"),r=(t==null?void 0:t.onHighlighted)||m("onHighlighted"),l=(i==null?void 0:i.onDeselected)||m("onDeselected"),c=m(),p=g();!s&&l&&l(w?void 0:o,i,{config:c,state:p}),f&&f(d?void 0:e,t,{config:c,state:p});const u=!s&&a;let h=!1;wn(),T("previousStep",i),T("previousElement",o),T("activeStep",t),T("activeElement",e);const v=()=>{if(g("__transitionCallback")!==v)return;const y=Date.now()-n,S=400-y<=400/2;t.popover&&S&&!h&&u&&(qe(e,t),h=!0),m("animate")&&y<400?sn(y,400,o,e):(lt(e),r&&r(d?void 0:e,t,{config:m(),state:g()}),T("__transitionCallback",void 0),T("__previousStep",i),T("__previousElement",o),T("__activeStep",t),T("__activeElement",e)),window.requestAnimationFrame(v)};T("__transitionCallback",v),window.requestAnimationFrame(v),at(e),!u&&t.popover&&qe(e,t),o.classList.remove("driver-active-element","driver-no-interaction"),o.removeAttribute("aria-haspopup"),o.removeAttribute("aria-expanded"),o.removeAttribute("aria-controls"),m("disableActiveInteraction")&&e.classList.add("driver-no-interaction"),e.classList.add("driver-active-element"),e.setAttribute("aria-haspopup","dialog"),e.setAttribute("aria-expanded","true"),e.setAttribute("aria-controls","driver-popover-content")}function fn(){var e;(e=document.getElementById("driver-dummy-element"))==null||e.remove(),document.querySelectorAll(".driver-active-element").forEach(t=>{t.classList.remove("driver-active-element","driver-no-interaction"),t.removeAttribute("aria-haspopup"),t.removeAttribute("aria-expanded"),t.removeAttribute("aria-controls")})}function ae(){const e=g("__resizeTimeout");e&&window.cancelAnimationFrame(e),T("__resizeTimeout",window.requestAnimationFrame(un))}function mn(e){var t;if(!g("isInitialized")||!(e.key==="Tab"||e.keyCode===9))return;const n=g("__activeElement"),i=(t=g("popover"))==null?void 0:t.wrapper,o=st([...i?[i]:[],...n?[n]:[]]),s=o[0],d=o[o.length-1];if(e.preventDefault(),e.shiftKey){const w=o[o.indexOf(document.activeElement)-1]||d;w==null||w.focus()}else{const w=o[o.indexOf(document.activeElement)+1]||s;w==null||w.focus()}}function vt(e){var t;((t=m("allowKeyboardControl"))==null||t)&&(e.key==="Escape"?j("escapePress"):e.key==="ArrowRight"?j("arrowRightPress"):e.key==="ArrowLeft"&&j("arrowLeftPress"))}function ut(e,t,n){const i=(o,s)=>{const d=o.target;e.contains(d)&&((!n||n(d))&&(o.preventDefault(),o.stopPropagation(),o.stopImmediatePropagation()),s==null||s(o))};document.addEventListener("pointerdown",i,!0),document.addEventListener("mousedown",i,!0),document.addEventListener("pointerup",i,!0),document.addEventListener("mouseup",i,!0),document.addEventListener("click",o=>{i(o,t)},!0)}function gn(){window.addEventListener("keyup",vt,!1),window.addEventListener("keydown",mn,!1),window.addEventListener("resize",ae),window.addEventListener("scroll",ae)}function hn(){window.removeEventListener("keyup",vt),window.removeEventListener("resize",ae),window.removeEventListener("scroll",ae)}function wn(){const e=g("popover");e&&(e.wrapper.style.display="none")}function qe(e,t){var n,i;let o=g("popover");o&&document.body.removeChild(o.wrapper),o=yn(),document.body.appendChild(o.wrapper);const{title:s,description:d,showButtons:w,disableButtons:a,showProgress:f,nextBtnText:r=m("nextBtnText")||"Next &rarr;",prevBtnText:l=m("prevBtnText")||"&larr; Previous",progressText:c=m("progressText")||"{current} of {total}"}=t.popover||{};o.nextButton.innerHTML=r,o.previousButton.innerHTML=l,o.progress.innerHTML=c,s?(o.title.innerHTML=s,o.title.style.display="block"):o.title.style.display="none",d?(o.description.innerHTML=d,o.description.style.display="block"):o.description.style.display="none";const p=w||m("showButtons"),u=f||m("showProgress")||!1,h=(p==null?void 0:p.includes("next"))||(p==null?void 0:p.includes("previous"))||u;o.closeButton.style.display=p.includes("close")?"block":"none",h?(o.footer.style.display="flex",o.progress.style.display=u?"block":"none",o.nextButton.style.display=p.includes("next")?"block":"none",o.previousButton.style.display=p.includes("previous")?"block":"none"):o.footer.style.display="none";const v=a||m("disableButtons")||[];v!=null&&v.includes("next")&&(o.nextButton.disabled=!0,o.nextButton.classList.add("driver-popover-btn-disabled")),v!=null&&v.includes("previous")&&(o.previousButton.disabled=!0,o.previousButton.classList.add("driver-popover-btn-disabled")),v!=null&&v.includes("close")&&(o.closeButton.disabled=!0,o.closeButton.classList.add("driver-popover-btn-disabled"));const y=o.wrapper;y.style.display="block",y.style.left="",y.style.top="",y.style.bottom="",y.style.right="",y.id="driver-popover-content",y.setAttribute("role","dialog"),y.setAttribute("aria-labelledby","driver-popover-title"),y.setAttribute("aria-describedby","driver-popover-description");const S=o.arrow;S.className="driver-popover-arrow";const _=((n=t.popover)==null?void 0:n.popoverClass)||m("popoverClass")||"";y.className=`driver-popover ${_}`.trim(),ut(o.wrapper,B=>{var V,A,x;const P=B.target,M=((V=t.popover)==null?void 0:V.onNextClick)||m("onNextClick"),W=((A=t.popover)==null?void 0:A.onPrevClick)||m("onPrevClick"),H=((x=t.popover)==null?void 0:x.onCloseClick)||m("onCloseClick");if(P.classList.contains("driver-popover-next-btn"))return M?M(e,t,{config:m(),state:g()}):j("nextClick");if(P.classList.contains("driver-popover-prev-btn"))return W?W(e,t,{config:m(),state:g()}):j("prevClick");if(P.classList.contains("driver-popover-close-btn"))return H?H(e,t,{config:m(),state:g()}):j("closeClick")},B=>!(o!=null&&o.description.contains(B))&&!(o!=null&&o.title.contains(B))&&typeof B.className=="string"&&B.className.includes("driver-popover")),T("popover",o);const b=((i=t.popover)==null?void 0:i.onPopoverRender)||m("onPopoverRender");b&&b(o,{config:m(),state:g()}),ft(e,t),at(y);const $=e.classList.contains("driver-dummy-element"),L=st([y,...$?[]:[e]]);L.length>0&&L[0].focus()}function pt(){const e=g("popover");if(!(e!=null&&e.wrapper))return;const t=e.wrapper.getBoundingClientRect(),n=m("stagePadding")||0,i=m("popoverOffset")||0;return{width:t.width+n+i,height:t.height+n+i,realWidth:t.width,realHeight:t.height}}function Ve(e,t){const{elementDimensions:n,popoverDimensions:i,popoverPadding:o,popoverArrowDimensions:s}=t;return e==="start"?Math.max(Math.min(n.top-o,window.innerHeight-i.realHeight-s.width),s.width):e==="end"?Math.max(Math.min(n.top-(i==null?void 0:i.realHeight)+n.height+o,window.innerHeight-(i==null?void 0:i.realHeight)-s.width),s.width):e==="center"?Math.max(Math.min(n.top+n.height/2-(i==null?void 0:i.realHeight)/2,window.innerHeight-(i==null?void 0:i.realHeight)-s.width),s.width):0}function Ye(e,t){const{elementDimensions:n,popoverDimensions:i,popoverPadding:o,popoverArrowDimensions:s}=t;return e==="start"?Math.max(Math.min(n.left-o,window.innerWidth-i.realWidth-s.width),s.width):e==="end"?Math.max(Math.min(n.left-(i==null?void 0:i.realWidth)+n.width+o,window.innerWidth-(i==null?void 0:i.realWidth)-s.width),s.width):e==="center"?Math.max(Math.min(n.left+n.width/2-(i==null?void 0:i.realWidth)/2,window.innerWidth-(i==null?void 0:i.realWidth)-s.width),s.width):0}function ft(e,t){const n=g("popover");if(!n)return;const{align:i="start",side:o="left"}=(t==null?void 0:t.popover)||{},s=i,d=e.id==="driver-dummy-element"?"over":o,w=m("stagePadding")||0,a=pt(),f=n.arrow.getBoundingClientRect(),r=e.getBoundingClientRect(),l=r.top-a.height;let c=l>=0;const p=window.innerHeight-(r.bottom+a.height);let u=p>=0;const h=r.left-a.width;let v=h>=0;const y=window.innerWidth-(r.right+a.width);let S=y>=0;const _=!c&&!u&&!v&&!S;let b=d;if(d==="top"&&c?S=v=u=!1:d==="bottom"&&u?S=v=c=!1:d==="left"&&v?S=c=u=!1:d==="right"&&S&&(v=c=u=!1),d==="over"){const $=window.innerWidth/2-a.realWidth/2,L=window.innerHeight/2-a.realHeight/2;n.wrapper.style.left=`${$}px`,n.wrapper.style.right="auto",n.wrapper.style.top=`${L}px`,n.wrapper.style.bottom="auto"}else if(_){const $=window.innerWidth/2-(a==null?void 0:a.realWidth)/2,L=10;n.wrapper.style.left=`${$}px`,n.wrapper.style.right="auto",n.wrapper.style.bottom=`${L}px`,n.wrapper.style.top="auto"}else if(v){const $=Math.min(h,window.innerWidth-(a==null?void 0:a.realWidth)-f.width),L=Ve(s,{elementDimensions:r,popoverDimensions:a,popoverPadding:w,popoverArrowDimensions:f});n.wrapper.style.left=`${$}px`,n.wrapper.style.top=`${L}px`,n.wrapper.style.bottom="auto",n.wrapper.style.right="auto",b="left"}else if(S){const $=Math.min(y,window.innerWidth-(a==null?void 0:a.realWidth)-f.width),L=Ve(s,{elementDimensions:r,popoverDimensions:a,popoverPadding:w,popoverArrowDimensions:f});n.wrapper.style.right=`${$}px`,n.wrapper.style.top=`${L}px`,n.wrapper.style.bottom="auto",n.wrapper.style.left="auto",b="right"}else if(c){const $=Math.min(l,window.innerHeight-a.realHeight-f.width);let L=Ye(s,{elementDimensions:r,popoverDimensions:a,popoverPadding:w,popoverArrowDimensions:f});n.wrapper.style.top=`${$}px`,n.wrapper.style.left=`${L}px`,n.wrapper.style.bottom="auto",n.wrapper.style.right="auto",b="top"}else if(u){const $=Math.min(p,window.innerHeight-(a==null?void 0:a.realHeight)-f.width);let L=Ye(s,{elementDimensions:r,popoverDimensions:a,popoverPadding:w,popoverArrowDimensions:f});n.wrapper.style.left=`${L}px`,n.wrapper.style.bottom=`${$}px`,n.wrapper.style.top="auto",n.wrapper.style.right="auto",b="bottom"}_?n.arrow.classList.add("driver-popover-arrow-none"):_n(s,b,e)}function _n(e,t,n){const i=g("popover");if(!i)return;const o=n.getBoundingClientRect(),s=pt(),d=i.arrow,w=s.width,a=window.innerWidth,f=o.width,r=o.left,l=s.height,c=window.innerHeight,p=o.top,u=o.height;d.className="driver-popover-arrow";let h=t,v=e;t==="top"?(r+f<=0?(h="right",v="end"):r+f-w<=0&&(h="top",v="start"),r>=a?(h="left",v="end"):r+w>=a&&(h="top",v="end")):t==="bottom"?(r+f<=0?(h="right",v="start"):r+f-w<=0&&(h="bottom",v="start"),r>=a?(h="left",v="start"):r+w>=a&&(h="bottom",v="end")):t==="left"?(p+u<=0?(h="bottom",v="end"):p+u-l<=0&&(h="left",v="start"),p>=c?(h="top",v="end"):p+l>=c&&(h="left",v="end")):t==="right"&&(p+u<=0?(h="bottom",v="start"):p+u-l<=0&&(h="right",v="start"),p>=c?(h="top",v="start"):p+l>=c&&(h="right",v="end")),h?(d.classList.add(`driver-popover-arrow-side-${h}`),d.classList.add(`driver-popover-arrow-align-${v}`)):d.classList.add("driver-popover-arrow-none")}function yn(){const e=document.createElement("div");e.classList.add("driver-popover");const t=document.createElement("div");t.classList.add("driver-popover-arrow");const n=document.createElement("header");n.id="driver-popover-title",n.classList.add("driver-popover-title"),n.style.display="none",n.innerText="Popover Title";const i=document.createElement("div");i.id="driver-popover-description",i.classList.add("driver-popover-description"),i.style.display="none",i.innerText="Popover description is here";const o=document.createElement("button");o.type="button",o.classList.add("driver-popover-close-btn"),o.setAttribute("aria-label","Close"),o.innerHTML="&times;";const s=document.createElement("footer");s.classList.add("driver-popover-footer");const d=document.createElement("span");d.classList.add("driver-popover-progress-text"),d.innerText="";const w=document.createElement("span");w.classList.add("driver-popover-navigation-btns");const a=document.createElement("button");a.type="button",a.classList.add("driver-popover-prev-btn"),a.innerHTML="&larr; Previous";const f=document.createElement("button");return f.type="button",f.classList.add("driver-popover-next-btn"),f.innerHTML="Next &rarr;",w.appendChild(a),w.appendChild(f),s.appendChild(d),s.appendChild(w),e.appendChild(o),e.appendChild(t),e.appendChild(n),e.appendChild(i),e.appendChild(s),{wrapper:e,arrow:t,title:n,description:i,footer:s,previousButton:a,nextButton:f,closeButton:o,footerButtons:w,progress:d}}function bn(){var e;const t=g("popover");t&&((e=t.wrapper.parentElement)==null||e.removeChild(t.wrapper))}function xn(e={}){Se(e);function t(){m("allowClose")&&f()}function n(){const r=g("activeIndex"),l=m("steps")||[];if(typeof r>"u")return;const c=r+1;l[c]?a(c):f()}function i(){const r=g("activeIndex"),l=m("steps")||[];if(typeof r>"u")return;const c=r-1;l[c]?a(c):f()}function o(r){(m("steps")||[])[r]?a(r):f()}function s(){var r;if(g("__transitionCallback"))return;const l=g("activeIndex"),c=g("__activeStep"),p=g("__activeElement");if(typeof l>"u"||typeof c>"u"||typeof g("activeIndex")>"u")return;const u=((r=c.popover)==null?void 0:r.onPrevClick)||m("onPrevClick");if(u)return u(p,c,{config:m(),state:g()});i()}function d(){var r;if(g("__transitionCallback"))return;const l=g("activeIndex"),c=g("__activeStep"),p=g("__activeElement");if(typeof l>"u"||typeof c>"u")return;const u=((r=c.popover)==null?void 0:r.onNextClick)||m("onNextClick");if(u)return u(p,c,{config:m(),state:g()});n()}function w(){g("isInitialized")||(T("isInitialized",!0),document.body.classList.add("driver-active",m("animate")?"driver-fade":"driver-simple"),gn(),de("overlayClick",t),de("escapePress",t),de("arrowLeftPress",s),de("arrowRightPress",d))}function a(r=0){var l,c,p,u,h,v,y,S;const _=m("steps");if(!_){console.error("No steps to drive through"),f();return}if(!_[r]){f();return}T("__activeOnDestroyed",document.activeElement),T("activeIndex",r);const b=_[r],$=_[r+1],L=_[r-1],B=((l=b.popover)==null?void 0:l.doneBtnText)||m("doneBtnText")||"Done",V=m("allowClose"),A=typeof((c=b.popover)==null?void 0:c.showProgress)<"u"?(p=b.popover)==null?void 0:p.showProgress:m("showProgress"),x=(((u=b.popover)==null?void 0:u.progressText)||m("progressText")||"{{current}} of {{total}}").replace("{{current}}",`${r+1}`).replace("{{total}}",`${_.length}`),P=((h=b.popover)==null?void 0:h.showButtons)||m("showButtons"),M=["next","previous",...V?["close"]:[]].filter(J=>!(P!=null&&P.length)||P.includes(J)),W=((v=b.popover)==null?void 0:v.onNextClick)||m("onNextClick"),H=((y=b.popover)==null?void 0:y.onPrevClick)||m("onPrevClick"),Y=((S=b.popover)==null?void 0:S.onCloseClick)||m("onCloseClick");Fe({...b,popover:{showButtons:M,nextBtnText:$?void 0:B,disableButtons:[...L?[]:["previous"]],showProgress:A,progressText:x,onNextClick:W||(()=>{$?a(r+1):f()}),onPrevClick:H||(()=>{a(r-1)}),onCloseClick:Y||(()=>{f()}),...(b==null?void 0:b.popover)||{}}})}function f(r=!0){const l=g("__activeElement"),c=g("__activeStep"),p=g("__activeOnDestroyed"),u=m("onDestroyStarted");if(r&&u){const y=!l||(l==null?void 0:l.id)==="driver-dummy-element";u(y?void 0:l,c,{config:m(),state:g()});return}const h=(c==null?void 0:c.onDeselected)||m("onDeselected"),v=m("onDestroyed");if(document.body.classList.remove("driver-active","driver-fade","driver-simple"),hn(),bn(),fn(),cn(),rn(),ze(),l&&c){const y=l.id==="driver-dummy-element";h&&h(y?void 0:l,c,{config:m(),state:g()}),v&&v(y?void 0:l,c,{config:m(),state:g()})}p&&p.focus()}return{isActive:()=>g("isInitialized")||!1,refresh:ae,drive:(r=0)=>{w(),a(r)},setConfig:Se,setSteps:r=>{ze(),Se({...m(),steps:r})},getConfig:m,getState:g,getActiveIndex:()=>g("activeIndex"),isFirstStep:()=>g("activeIndex")===0,isLastStep:()=>{const r=m("steps")||[],l=g("activeIndex");return l!==void 0&&l===r.length-1},getActiveStep:()=>g("activeStep"),getActiveElement:()=>g("activeElement"),getPreviousElement:()=>g("previousElement"),getPreviousStep:()=>g("previousStep"),moveNext:n,movePrevious:i,moveTo:o,hasNextStep:()=>{const r=m("steps")||[],l=g("activeIndex");return l!==void 0&&r[l+1]},hasPreviousStep:()=>{const r=m("steps")||[],l=g("activeIndex");return l!==void 0&&r[l-1]},highlight:r=>{w(),Fe({...r,popover:r.popover?{showButtons:[],showProgress:!1,progressText:"",...r.popover}:void 0})},destroy:()=>{f(!1)}}}var Sn=(e,t)=>t(),kn=(e,t)=>t(),Cn=z('<div class="navbar bg-base-100"><div class="flex-1"><a class="btn btn-ghost text-xl">Splittermond Tickleiste</a></div> <div class="flex-none space-x-2"><label id="uploadButton" for="battleScene" class="btn"><img width="30em" alt="download"> Upload Scene</label> <input type="file" id="battleScene" name="battleScene" accept="application/json" class="battle-scene-file-input file-input w-full max-w-xs svelte-ekzg43"> <button id="downloadBtn" class="btn"><img width="30em" alt="download"> Download Scene</button> <button class="btn"><img width="30em" alt="download"></button></div></div>');function En(e,t){pe(t,!1);const n=u=>{const h=u.target;if(h&&h.files){const v=h.files[0];v&&Zt(v).then(y=>{it(y)}),h.value=""}},i=()=>{let u=U.name.toLowerCase().trim().replace(/\s+/g,"_");en(U,u)},o=()=>{xn({showProgress:!0,steps:[{element:"#sceneTitle",popover:{title:"Scene Title",description:"Shows the current scene's name."}},{element:"#combatantsTable",popover:{title:"Combatants List",description:"Displays the list of combatants part of the scene."}},{element:"#editSceneBtn",popover:{title:"Edit Scene",description:"Toggles edit mode to change the scene name and combatants list."}},{element:"#runSceneBtn",popover:{title:"Run Scene",description:"Ends edit mode and runs the scene which effectively means that all combatants will be ordered by ascending initiative. <b>When clicking a combatant in run mode, let's your choose a number of ticks</b> to be added to the combatants initiative value, followed by a reordering. <br/><br/> You can re-enter <b>edit mode</b> any time."}},{element:"#downloadBtn",popover:{title:"Download Scene",description:"Lets you download the current scene as JSON file."}},{element:"#uploadButton",popover:{title:"Upload Scene",description:"Lets you choose a scene to load that was previously saved to your device."}}]}).drive()};Ot();var s=Cn(),d=I(E(s),2),w=E(d),a=E(w);q(a,"src",`${K??""}/svg/upload-svgrepo-com.svg`),se(),C(w);var f=I(w,2);f.__change=n;var r=I(f,2);r.__click=[Sn,i];var l=E(r);q(l,"src",`${K??""}/svg/download-svgrepo-com.svg`),se(),C(r);var c=I(r,2);c.__click=[kn,o];var p=E(c);q(p,"src",`${K??""}/svg/circle-question-svgrepo-com.svg`),C(c),C(d),C(s),O(e,s),fe()}$e(["change","click"]);var Ln=(e,t,n)=>t(k(n)),An=z('<button class="btn svelte-2o3o2v"> </button>'),$n=(e,t)=>t(),Pn=z('<dialog id="tickSelectionModal" class="modal"><div class="modal-box"><form method="dialog"><button class="btn btn-circle btn-ghost btn-sm absolute right-2 top-2 svelte-2o3o2v">✕</button></form> <h3 class="mb-5 text-lg font-bold">Select ticks</h3> <div class="keypad svelte-2o3o2v"></div> <div><button class="btn svelte-2o3o2v"><img width="30em" alt="toggle negation"></button></div></div> <form method="dialog" class="modal-backdrop"><button class="svelte-2o3o2v">close</button></form></dialog>');function Bn(e,t){pe(t,!0);let n,i;const o=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20];let s=ke(!1);function d(){return n.showModal(),new Promise(v=>{i=v})}function w(){n.close()}function a(v){w();let y=k(s)?-1:1;i(y*v)}function f(){me(s,!k(s))}var r=Pn();Ce(r,v=>n=v,()=>n);var l=E(r),c=I(E(l),4);tt(c,21,()=>o,et,(v,y)=>{var S=An();S.__click=[Ln,a,y];var _=E(S,!0);C(S),Q(()=>ce(_,k(y))),O(v,S)}),C(c);var p=I(c,2),u=E(p);u.__click=[$n,f];var h=E(u);return q(h,"src",`${K??""}/svg/minus-svgrepo-com.svg`),C(u),C(p),C(l),se(2),C(r),Q(()=>re(u,"btn-active",k(s))),O(e,r),fe({show:d})}$e(["click"]);function Ge(e,t,n){e.key==="Enter"&&t(k(n))}function Nn(e,t,n){me(t,Z(n.Editing))}function Tn(e,t,n){me(t,Z(n.Running)),rt()}var Dn=z('<input type="text" placeholder="Scene name..." class="input input-bordered w-full max-w-xs">'),In=(e,t,n)=>t(k(n)),Mn=z('<div class="flex items-center bg-gray-200 p-2 rounded-b-lg mb-2"><div class="flex-1"><input type="text" placeholder="Name..." class="input input-bordered w-full max-w-xs"></div> <div class="flex-1"><input type="number" placeholder="Initiative..." class="input input-bordered w-full max-w-xs"></div> <div class="w-16 flex justify-center"><button class="btn"><img width="30" alt="add"></button></div></div>'),Hn=(e,t,n)=>t(k(n)),Rn=(e,t,n)=>t(k(n)),On=(e,t,n)=>t(k(n)),Wn=z('<input type="text" class="input input-bordered w-full max-w-xs">'),Un=z('<input type="number" class="input input-bordered w-full max-w-xs">'),Jn=(e,t,n)=>t(k(n).id),zn=z('<button class="btn"><img width="30" alt="delete"></button>'),Fn=z('<div class="flex items-center p-2 hover:bg-gray-100 cursor-pointer" role="button" tabindex="0"><div class="flex-1"><!></div> <div class="flex-1"><!></div> <div class="w-16 flex justify-center"><!></div></div>'),qn=z('<!> <div class="mx-48 mt-12 overflow-x-auto"><div class="navbar bg-base-100"><div id="sceneTitle" class="flex-1"><!></div> <div class="flex-none space-x-2"><button id="runSceneBtn" class="btn"><img width="30em" alt="download"> Run Scene</button> <button id="editSceneBtn" class="btn"><img width="30em" alt="toggle edit"> Edit Scene</button></div></div> <div id="combatantsTable" class="w-full"><div class="flex font-bold py-2 px-4 bg-gray-200"><div class="flex-1">Name</div> <div class="flex-1" id="initiativeColumn">Initiative</div> <div class="w-16"></div></div> <!> <!></div></div>',1);function Vn(e,t){pe(t,!0);const n={Editing:"EDITING",Running:"RUNNING"};let i=ke(Z(Ue())),o=ke(Z(n.Editing)),s,d;function w(A){A.name!==""&&(U.combatants.push(A),me(i,Z(Ue())),s.focus(),s.select())}function a(A){U.combatants=U.combatants.filter(x=>x.id!==A)}function f(A){k(o)===n.Running&&d.show().then(x=>{A.initiative+=x,rt()})}var r=qn(),l=Ze(r);Ce(Bn(l,{}),A=>d=A,()=>d);var c=I(l,2),p=E(c),u=E(p),h=E(u);ne(h,()=>k(o)===n.Editing,A=>{var x=Dn();oe(x),ie(x,()=>U.name,P=>U.name=P),O(A,x)},A=>{var x=ge();Q(()=>ce(x,U.name)),O(A,x)}),C(u);var v=I(u,2),y=E(v);y.__click=[Tn,o,n];var S=E(y);q(S,"src",`${K??""}/svg/circle-play-svgrepo-com.svg`),se(),C(y);var _=I(y,2);_.__click=[Nn,o,n];var b=E(_);q(b,"src",`${K??""}/svg/pencil-svgrepo-com.svg`),se(),C(_),C(v),C(p);var $=I(p,2),L=E($),B=I(L,2);ne(B,()=>k(o)===n.Editing,A=>{var x=Mn(),P=E(x),M=E(P);Ce(M,R=>s=R,()=>s),oe(M),M.__keydown=[Ge,w,i],C(P);var W=I(P,2),H=E(W);oe(H),H.__keydown=[Ge,w,i],C(W);var Y=I(W,2),J=E(Y);J.__click=[In,w,i];var X=E(J);q(X,"src",`${K??""}/svg/plus-svgrepo-com.svg`),C(J),C(Y),C(x),ie(M,()=>k(i).name,R=>k(i).name=R),ie(H,()=>k(i).initiative,R=>k(i).initiative=R),O(A,x)});var V=I(B,2);tt(V,17,()=>U.combatants,et,(A,x)=>{var P=Fn();P.__click=[Hn,f,x],P.__keydown=[Rn,f,x],P.__keyup=[On,f,x];var M=E(P),W=E(M);ne(W,()=>k(o)===n.Editing,R=>{var N=Wn();oe(N),ie(N,()=>k(x).name,ee=>k(x).name=ee),O(R,N)},R=>{var N=ge();Q(()=>ce(N,k(x).name)),O(R,N)}),C(M);var H=I(M,2),Y=E(H);ne(Y,()=>k(o)===n.Editing,R=>{var N=Un();oe(N),ie(N,()=>k(x).initiative,ee=>k(x).initiative=ee),O(R,N)},R=>{var N=ge();Q(()=>ce(N,k(x).initiative)),O(R,N)}),C(H);var J=I(H,2),X=E(J);ne(X,()=>k(o)===n.Editing,R=>{var N=zn();N.__click=[Jn,a,x];var ee=E(N);q(ee,"src",`${K??""}/svg/trash-svgrepo-com.svg`),C(N),O(R,N)}),C(J),C(P),O(A,P)}),C($),C(c),Q(()=>{re(y,"btn-active",k(o)===n.Running),re(_,"btn-active",k(o)===n.Editing),re(L,"rounded-t-lg",k(o)===n.Editing),re(L,"rounded-lg",k(o)===n.Running)}),O(e,r),fe()}$e(["click","keydown","keyup"]);var Yn=z("<!> <!>",1);function eo(e,t){pe(t,!0),Rt(()=>{const s=Xt();s&&it(s)}),Ht(()=>{Qt()});var n=Yn(),i=Ze(n);En(i,{});var o=I(i,2);Vn(o,{}),O(e,n),fe()}export{eo as component};
